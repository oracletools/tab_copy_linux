<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright 2010 . All rights reserved.
     Author: AlexBuzunov@gmail.com (Alex Buzunov)
     Python Implementation of CREF_LAST_COPY_DATE pipeline
-->
<etldataflow name="CREF_LAST_COPY_DATE" 
			 email_to="EMAIL_TO">

<worker name="CREF_MDWD_CREF_LAST_COPY_DATE">
  <exec_dml>
    <sqlp method="dml" >
	  <param name="DB_CONNECTOR" value="CREF_MDWD"></param>
	   <param name="SCHEMA_NAME" value="C155817REF"></param>
      <sql_template>
        <![CDATA[
set pagesize 100 line 200
SELECT CREF_MDWD, substr(LAST_COPY_DATE,1,18) LAST_COPY_DATE FROM (
SELECT '%SCHEMA_NAME%.REF_FX' CREF_MDWD, SCN_TO_TIMESTAMP( ORA_ROWSCN ) LAST_COPY_DATE FROM %SCHEMA_NAME%.REF_FX where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.REF_MTM', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.REF_MTM where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.REF_SECURE', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.REF_SECURE where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.REF_ESALES', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.REF_ESALES where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.REF_MNGD_SEG_HIER', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.REF_MNGD_SEG_HIER where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.REF_MNGD_SEG_XREF',SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.REF_MNGD_SEG_XREF where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.MAN_REF_MKT_OF_SETL', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.MAN_REF_MKT_OF_SETL where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.MAN_REF_LGL_ENTY_DATA', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.MAN_REF_LGL_ENTY_DATA where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.MAN_REF_LGL_ENTY_XREF', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.MAN_REF_LGL_ENTY_XREF where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.MAN_REF_TRAN_TYP', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.MAN_REF_TRAN_TYP where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.MAN_REF_ASET_LVL_DATA', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.MAN_REF_ASET_LVL_DATA where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.MAN_REF_PLAT_CLIENTS', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.MAN_REF_PLAT_CLIENTS where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.MAN_REF_OPS_OWN_HIER', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.MAN_REF_OPS_OWN_HIER where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.MAN_REF_FIRM_TMS', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.MAN_REF_FIRM_TMS where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.MAN_REF_FIRM_ETPL', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.MAN_REF_FIRM_ETPL where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.MAN_REF_MARKETSIDE_MAPNG', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.MAN_REF_MARKETSIDE_MAPNG where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.MAN_REF_SOEID_MAPNG', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.MAN_REF_SOEID_MAPNG where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.MAN_REF_SOLAR', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.MAN_REF_SOLAR where rownum=1 UNION ALL
SELECT '%SCHEMA_NAME%.MAN_REF_STGY_TO_DESK', SCN_TO_TIMESTAMP( ORA_ROWSCN )  FROM %SCHEMA_NAME%.MAN_REF_STGY_TO_DESK where rownum=1 
) ORDER BY 1;
]]>
      </sql_template>
    </sqlp>
  </exec_dml>
</worker> 




</etldataflow>