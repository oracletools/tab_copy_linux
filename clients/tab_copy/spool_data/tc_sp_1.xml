<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright 2011 . All rights reserved.
     Author: AlexBuzunov@gmail.com (Alex Buzunov)
     Python Implementation of ETL pipeline
-->
<etldataflow name="SPOOL_BK94994_TEST">
<globals>

	<!-- PIPELINE execution type
		 SYNC - synchronous, ANYNC - asynchronous 
	-->
	  <param name="FLOW_TYPE" value="SYNC"></param>	

	  <param name="FIELD_TERMINATOR" value="|"></param>
	  <param name="LINE_TERMINATOR" value="''"></param>
	  
  
	  <param name="FROM_DB" value="%CSMARTBSER_SMARTQ1%"></param>
	  <param name="FROM_DB1" value="%AB_SMARTP1B%"></param>
	  <param name="FROM_SCHEMA" value="CSMARTBSER"></param>
	  <param name="DB_CONNECTOR" value="%CSMARTBSER_SMARTQ1%"></param>
	  
	  
	   <!--will spool ALL records if LAME_DUCK=0-->
	  <param name="LAME_DUCK" value='0'></param>
	  <param name="ARRAYSIZE" value="5000"></param>
	  <param name="COPYCOMMIT" value="4"></param>
	  <!--sqlp attribute-->
		
		
	  <param name="SOURCE_FILE" value="--replaced from command line"></param>	
	  <param name="COB_YEAR" value="--replaced from command line"></param>

</globals>



<worker1 name="STG_OTC_CWM.SPOOL_06">
  <exec_query_spool>
    <table_utils 	method="%QUERY_SPOOL_METHOD%" >
     	<param name="IF_COMPRESSED_SPOOL" value="0"></param>
      <sql_template>
        <![CDATA[ 
SELECT /*+PARALLEL*/A.DEAL,A.TRANSACTIONID,A.CREDITDEFAULTSWAPREF,A.CONFIMATIONSTATUS,A.CONFIRMATIONSTATUSREASON,A.CONFIRMATIONSTATUSSUBTYPE,A.COUNTERPARTYACCOUNT,A.COUNTERPARTYACCOUNTNUMBER,A.COUNTERPARTYDESK,A.COUNTERPARTYLEGALENTITY,A.COUNTERPARTYNAME,A.CURRENCY,A.ENTRYDATE,A.EVENTTYPE,A.FIRMROLE,A.LOCATION,A.MASTERCONFAGREEMENTTYPE,A.MASTERAGRRMENTEXTENSION,A.MASTERAGREEMENTMNEMONIC,A.MASTERAGREEMENTSHELF,A.MTMVALUE,A.MTMVALUEDATE,A.NOTIONAL,A.NUMBEROFCONTRACTS,A.OPERATIONFILE,A.PARTYACCOUNT,A.PARTYACCOUNTNUMBER,A.PARTYDESK,A.PARTYLEGALENTITY,A.PARTYPOSITION,A.PARTYRELATIONSHIP,A.PAYSIDECURRENCY,A.PAYSIDENOTIONAL,A.PAYSIDENOTIONALCURRENCY,A.PRIMARYSYSTEM,A.PRIMARYTRANSACTIONID,A.PRODUCTCLASS,A.RECEIVINGSIDECURRENCY,A.RECEIVINGSIDENOTIONAL,A.RECEIVINGSIDENOTIONALCURRENCY,A.SECURITYAGREEMENT,A.SECURITYAGREEMENTSTATUS,A.SETTLEMENTDATE,A.SETTLEMENTMETHOD,A.SALESPERSON,A.STRIKERATE,A.TAXMNEMONIC,A.TERMINATIONDATE,A.ACTUALTERMINATIONDATE,A.TRADEDATE,A.TRADER,A.TRADESTATUS,A.TRADETERMINATIONREASON,A.TYPEOFDEAL,A.EXTERNALSYSTEM,A.EXTERNALTRADENUMBER,A.OWNERSHIP,A.VERBALSTATUS,A.TYPEOFCONFIRM,A.OPERATIONSCENTER,A.CONFIRMATIONSTATUS1,A.DEPOTCORPUNITGFCID,A.FIRMGFPID,A.GFCID,A.CUSTOMERGFPID,A.REFERENCEENTITY,A.MANAGERGROUPNAME,A.CALCULATIONAGENTCITY,A.CUSTOMERREFERENCE,A.ITEMCOUNT,A.UNDERLYINGCUSIP,A.UNDERLYING,A.COBDATE,A.STGYCODE,A.STGY,A.ATTACHMENTPOINTPERCENTAGE,A.EXHAUSTIONPOINTPERCENTAGE,A.CREDITEVENTONTHETRADE,A.OBLIGATIONACCELERATION,A.DOCUMENTATION,A.CONFIRMID,A.PRODUCTTYPE,A.STATE,A.PARENTCOUNTERPARTYNAME,A.PAYSIDEPRINMDL,A.RCVSIDEPRINMDL,A.PAYSIDEPRODCORP,A.RCVSIDEPRODCORP,A.PAYSIDEPRODCLAS,A.RCVSIDEPRODCLAS,A.TYPEOFOPT,A.SUBCLAS,A.STATENUM,A.STATEVERNUM,A.REFERENCESPOTRATE,A.CURRPRDPYMTDT,A.AMENDREASON,A.COB_CURRENCY,A.COB_PAYSIDENOTATIONALCURRENCY,A.COB_RECSIDENOTATIONALCURRENCY,A.FIX_RT,A.MARGININGFREQUENCY,A.TRIGGERAMOUNT,A.MINIUMAMOUNT,A.MTMCURRENCY,A.NETTINGID,A.NETTINGFLAG,A.INITIALMARGIN,A.COLLATERALMARGIN,A.PAY_NOTL_USD,A.RECEIVESIDENOTIONAL,A.CDXTRADETYPE,A.NOTIONALUSD,A.REDID,A.SOURCESYSTEMCODE,A.SOURCEFILEUID,A.CREATEDBY,A.CREATEDTIMESTAMP,A.DERIVEDOWNERSHIPCODE,A.LEGAL_ENTITY_KEY,A.COUNTERPARTY_UNIQUE_ID_GRD,A.LOGICALNAME,A.CEDISPLAYNAME,A.CDSSPREAD,A.SOURCESYSTEM,A.D_ENTRYDATE,A.D_MTMVALUEDATE,A.D_SETTLEMENTDATE,A.D_TERMINATIONDATE,A.D_ACTUALTERMINATIONDATE,A.D_TRADEDATE,A.D_FILE_DATE,A.D_CURPERIODPYMTDT, TAGEBUSINESS,A.TRD_AGEBAND,A.UNIQ_ID,
B.affirmationperson,B.affirmationteam,B.businessline,B.businessunitmanager,B.confirmationstatus,B.confirmationsubstatus,B.age,B.confirmcategory,B.confirmstatlastmodified,B.confirmstatlastmodifiedby,B.deskname,B.earlyterminationdate,B.generator,B.generatorteam,B.lasteconomicmodification,B.linkedconfirmed,B.matcher,B.matcherteam,B.middleofficehead,B.modificationflag,B.previousworkflowstep,B.product,B.productcontroller,B.reconstatus,B.reviewer,B.reviewerteam,B.sentflag,B.specialhandling,B.stateversionnumber,B.strategy,B.strategycode,B.substrategy,B.tradingdeskhead,B.workflowstep  --,C.goc
from (select  D.deal,D.transactionid,D.affirmationperson,D.affirmationteam,D.businessline,D.businessunitmanager,D.confirmationstatus,D.confirmationsubstatus,D.age,D.
confirmcategory,D.confirmid,D.confirmstatlastmodified,D.confirmstatlastmodifiedby,D.createdtimestamp,D.deskname,D.
earlyterminationdate,D.generator,D.generatorteam,D.lasteconomicmodification,D.linkedconfirmed,D.matcher,D.matcherteam,D.
middleofficehead,D.modificationflag,D.previousworkflowstep,D.product,D.productcontroller,D.producttype,D.reconstatus,D.reviewer,D.reviewerteam,D.
sentflag,D.specialhandling,D.state,D.stateversionnumber,D.strategy,D.strategycode,D.substrategy,D.tradeterminationreason,D.
tradingdeskhead,D.workflowstep,D.verbalstatus,D.typeofconfirm from (
SELECT --+PARALLEL
   --MAX (rid) KEEP (DENSE_RANK FIRST ORDER BY D.confirmid) OVER (PARTITION BY D.deal , D.transactionid) mrid,
   ROW_NUMBER ()  OVER (PARTITION BY D.DEAL , D.TRANSACTIONID ORDER BY D.confirmid, crtd_dt DESC) rn,
  d.*
    FROM  (select d.*
    --ROW_NUMBER () OVER (PARTITION BY D.DEAL , D.TRANSACTIONID ORDER BY D.confirmid, crtd_dt DESC) rn
    from CSMARTVOL.STG_OTC_CWM d
     )d
     ) d where rn=1 and UPPER(SUBSTR(TRIM(deal), 1, 2)) ='04'
     )  B,
( select --+9PARALLEL
 A.DEAL,A.TRANSACTIONID,A.CREDITDEFAULTSWAPREF,A.CONFIMATIONSTATUS,A.CONFIRMATIONSTATUSREASON,A.CONFIRMATIONSTATUSSUBTYPE,A.COUNTERPARTYACCOUNT,A.COUNTERPARTYACCOUNTNUMBER,A.COUNTERPARTYDESK,A.COUNTERPARTYLEGALENTITY,A.COUNTERPARTYNAME,A.CURRENCY,A.ENTRYDATE,A.EVENTTYPE,A.FIRMROLE,A.LOCATION,A.MASTERCONFAGREEMENTTYPE,A.MASTERAGRRMENTEXTENSION,A.MASTERAGREEMENTMNEMONIC,A.MASTERAGREEMENTSHELF,A.MTMVALUE,A.MTMVALUEDATE,A.NOTIONAL,A.NUMBEROFCONTRACTS,A.OPERATIONFILE,A.PARTYACCOUNT,A.PARTYACCOUNTNUMBER,A.PARTYDESK,A.PARTYLEGALENTITY,A.PARTYPOSITION,A.PARTYRELATIONSHIP,A.PAYSIDECURRENCY,A.PAYSIDENOTIONAL,A.PAYSIDENOTIONALCURRENCY,A.PRIMARYSYSTEM,A.PRIMARYTRANSACTIONID,A.PRODUCTCLASS,A.RECEIVINGSIDECURRENCY,A.RECEIVINGSIDENOTIONAL,A.RECEIVINGSIDENOTIONALCURRENCY,A.SECURITYAGREEMENT,A.SECURITYAGREEMENTSTATUS,A.SETTLEMENTDATE,A.SETTLEMENTMETHOD,A.SALESPERSON,A.STRIKERATE,A.TAXMNEMONIC,A.TERMINATIONDATE,A.ACTUALTERMINATIONDATE,A.TRADEDATE,A.TRADER,A.TRADESTATUS,A.TRADETERMINATIONREASON,A.TYPEOFDEAL,A.EXTERNALSYSTEM,A.EXTERNALTRADENUMBER,A.OWNERSHIP,A.VERBALSTATUS,A.TYPEOFCONFIRM,A.OPERATIONSCENTER,A.CONFIRMATIONSTATUS1,A.DEPOTCORPUNITGFCID,A.FIRMGFPID,A.GFCID,A.CUSTOMERGFPID,A.REFERENCEENTITY,A.MANAGERGROUPNAME,A.CALCULATIONAGENTCITY,A.CUSTOMERREFERENCE,A.ITEMCOUNT,A.UNDERLYINGCUSIP,A.UNDERLYING,A.COBDATE,A.STGYCODE,A.STGY,A.ATTACHMENTPOINTPERCENTAGE,A.EXHAUSTIONPOINTPERCENTAGE,A.CREDITEVENTONTHETRADE,A.OBLIGATIONACCELERATION,A.DOCUMENTATION,A.CONFIRMID,A.PRODUCTTYPE,A.STATE,A.PARENTCOUNTERPARTYNAME,A.PAYSIDEPRINMDL,A.RCVSIDEPRINMDL,A.PAYSIDEPRODCORP,A.RCVSIDEPRODCORP,A.PAYSIDEPRODCLAS,A.RCVSIDEPRODCLAS,A.TYPEOFOPT,A.SUBCLAS,A.STATENUM,A.STATEVERNUM,A.REFERENCESPOTRATE,A.CURRPRDPYMTDT,A.AMENDREASON,A.COB_CURRENCY,A.COB_PAYSIDENOTATIONALCURRENCY,A.COB_RECSIDENOTATIONALCURRENCY,A.FIX_RT,A.MARGININGFREQUENCY,A.TRIGGERAMOUNT,A.MINIUMAMOUNT,A.MTMCURRENCY,A.NETTINGID,A.NETTINGFLAG,A.INITIALMARGIN,A.COLLATERALMARGIN,A.PAY_NOTL_USD,A.RECEIVESIDENOTIONAL,A.CDXTRADETYPE,A.NOTIONALUSD,A.REDID,A.SOURCESYSTEMCODE,A.SOURCEFILEUID,A.CREATEDBY,A.CREATEDTIMESTAMP,A.DERIVEDOWNERSHIPCODE,A.LEGAL_ENTITY_KEY,A.COUNTERPARTY_UNIQUE_ID_GRD,A.LOGICALNAME,A.CEDISPLAYNAME,A.CDSSPREAD,A.SOURCESYSTEM,A.D_ENTRYDATE,A.D_MTMVALUEDATE,A.D_SETTLEMENTDATE,A.D_TERMINATIONDATE,A.D_ACTUALTERMINATIONDATE,A.D_TRADEDATE,A.D_FILE_DATE,A.D_CURPERIODPYMTDT,
  11230 -  trd.agedbusinessdays TAGEBUSINESS ,A.TRD_AGEBAND,A.UNIQ_ID
    from STG_OASYS_FEED_OLD --PARTITION (part_23)
    A , v_del_trd trd  where  trd.cobdate =A.D_TRADEDATE and UPPER(SUBSTR(TRIM(deal), 1, 2)) ='04'
) A --,
--DEV_XREF C
where A.deal=B.deal --(+)
and A.transactionid=B.transactionid --(+)
	 ;
]]>
      </sql_template>
    </table_utils>
  </exec_query_spool>
</worker1>


<worker1 name="STG_OTC_CWM.SPOOL_06">
  <exec_query_spool>
    <table_utils 	method="%QUERY_SPOOL_METHOD%" >
     	<param name="IF_COMPRESSED_SPOOL" value="0"></param>
      <sql_template>
        <![CDATA[ 
select --+parallel
* from del_v_sp_1
	 ;
]]>
      </sql_template>
    </table_utils>
  </exec_query_spool>
</worker1>


<worker name="STG_OTC_CWM.SPOOL_06">
  <exec_query_spool>
    <table_utils 	method="%QUERY_SPOOL_METHOD%" >
     	<param name="IF_COMPRESSED_SPOOL" value="0"></param>
      <sql_template>
        <![CDATA[ 
SELECT *                                       
  FROM TABLE(                                  
                 pkg_df_pre_spool_2.fp_spool_prll(                       
                             CURSOR(
                                     SELECT /*+PARALLEL(A, 8,1) PARALLEL (B,8,1) */ ot_spool_row(A.DEAL,A.TRANSACTIONID,A.CREDITDEFAULTSWAPREF,A.CONFIMATIONSTATUS,A.CONFIRMATIONSTATUSREASON,A.CONFIRMATIONSTATUSSUBTYPE,A.COUNTERPARTYACCOUNT,A.COUNTERPARTYACCOUNTNUMBER,A.COUNTERPARTYDESK,A.COUNTERPARTYLEGALENTITY,A.COUNTERPARTYNAME,A.CURRENCY,A.ENTRYDATE,A.EVENTTYPE,A.FIRMROLE,A.LOCATION,A.MASTERCONFAGREEMENTTYPE,A.MASTERAGRRMENTEXTENSION,A.MASTERAGREEMENTMNEMONIC,A.MASTERAGREEMENTSHELF,A.MTMVALUE,A.MTMVALUEDATE,A.NOTIONAL,A.NUMBEROFCONTRACTS,A.OPERATIONFILE,A.PARTYACCOUNT,A.PARTYACCOUNTNUMBER,A.PARTYDESK,A.PARTYLEGALENTITY,A.PARTYPOSITION,A.PARTYRELATIONSHIP,A.PAYSIDECURRENCY,A.PAYSIDENOTIONAL,A.PAYSIDENOTIONALCURRENCY,A.PRIMARYSYSTEM,A.PRIMARYTRANSACTIONID,A.PRODUCTCLASS,A.RECEIVINGSIDECURRENCY,A.RECEIVINGSIDENOTIONAL,A.RECEIVINGSIDENOTIONALCURRENCY,A.SECURITYAGREEMENT,A.SECURITYAGREEMENTSTATUS,A.SETTLEMENTDATE,A.SETTLEMENTMETHOD,A.SALESPERSON,A.STRIKERATE,A.TAXMNEMONIC,A.TERMINATIONDATE,A.ACTUALTERMINATIONDATE,A.TRADEDATE,A.TRADER,A.TRADESTATUS,A.TRADETERMINATIONREASON,A.TYPEOFDEAL,A.EXTERNALSYSTEM,A.EXTERNALTRADENUMBER,A.OWNERSHIP,A.VERBALSTATUS,A.TYPEOFCONFIRM,A.OPERATIONSCENTER,A.CONFIRMATIONSTATUS1,A.DEPOTCORPUNITGFCID,A.FIRMGFPID,A.GFCID,A.CUSTOMERGFPID,A.REFERENCEENTITY,A.MANAGERGROUPNAME,A.CALCULATIONAGENTCITY,A.CUSTOMERREFERENCE,A.ITEMCOUNT,A.UNDERLYINGCUSIP,A.UNDERLYING,A.COBDATE,A.STGYCODE,A.STGY,A.ATTACHMENTPOINTPERCENTAGE,A.EXHAUSTIONPOINTPERCENTAGE,A.CREDITEVENTONTHETRADE,A.OBLIGATIONACCELERATION,A.DOCUMENTATION,A.CONFIRMID,A.PRODUCTTYPE,A.STATE,A.PARENTCOUNTERPARTYNAME,A.PAYSIDEPRINMDL,A.RCVSIDEPRINMDL,A.PAYSIDEPRODCORP,A.RCVSIDEPRODCORP,A.PAYSIDEPRODCLAS,A.RCVSIDEPRODCLAS,A.TYPEOFOPT,A.SUBCLAS,A.STATENUM,A.STATEVERNUM,A.REFERENCESPOTRATE,A.CURRPRDPYMTDT,A.AMENDREASON,A.COB_CURRENCY,A.COB_PAYSIDENOTATIONALCURRENCY,A.COB_RECSIDENOTATIONALCURRENCY,A.FIX_RT,A.MARGININGFREQUENCY,A.TRIGGERAMOUNT,A.MINIUMAMOUNT,A.MTMCURRENCY,A.NETTINGID,A.NETTINGFLAG,A.INITIALMARGIN,A.COLLATERALMARGIN,A.PAY_NOTL_USD,A.RECEIVESIDENOTIONAL,A.CDXTRADETYPE,A.NOTIONALUSD,A.REDID,A.SOURCESYSTEMCODE,A.SOURCEFILEUID,A.CREATEDBY,A.CREATEDTIMESTAMP,A.DERIVEDOWNERSHIPCODE,A.LEGAL_ENTITY_KEY,A.COUNTERPARTY_UNIQUE_ID_GRD,A.LOGICALNAME,A.CEDISPLAYNAME,A.CDSSPREAD,A.SOURCESYSTEM,A.D_ENTRYDATE,A.D_MTMVALUEDATE,A.D_SETTLEMENTDATE,A.D_TERMINATIONDATE,A.D_ACTUALTERMINATIONDATE,A.D_TRADEDATE,A.D_FILE_DATE,A.D_CURPERIODPYMTDT, TAGEBUSINESS,A.TRD_AGEBAND,A.UNIQ_ID,
B.affirmationperson,B.affirmationteam,B.businessline,B.businessunitmanager,B.confirmationstatus,B.confirmationsubstatus,
B.age,B.confirmcategory,B.confirmstatlastmodified,B.confirmstatlastmodifiedby,B.deskname,
B.earlyterminationdate,B.generator,B.generatorteam,B.lasteconomicmodification,B.linkedconfirmed,B.matcher,B.matcherteam,
B.middleofficehead,B.modificationflag,B.previousworkflowstep,B.product,B.productcontroller,B.reconstatus,B.reviewer,B.reviewerteam,
B.sentflag,B.specialhandling,B.stateversionnumber,B.strategy,B.strategycode,B.substrategy,
B.tradingdeskhead,B.workflowstep  ,C.goc) obj
from DEV_FIN_11_F2 B ,  STG_OASYS_FEED_F2 A, DEV_XREF C
where A.deal=B.deal (+)
and A.transactionid=B.transactionid (+)
and A.partyaccountnumber =C.firm_acct(+)
                                   ))
                            )
	 ;
]]>
      </sql_template>
    </table_utils>
  </exec_query_spool>
</worker>


<worker1 name="STG_OTC_CWM.SPOOL_06">
  <exec_query_spool>
    <table_utils 	method="%QUERY_SPOOL_METHOD%" >
     	<param name="IF_COMPRESSED_SPOOL" value="0"></param>
      <sql_template>
        <![CDATA[ 
SELECT /*+PARALLEL*/A.DEAL,A.TRANSACTIONID,A.CREDITDEFAULTSWAPREF,A.CONFIMATIONSTATUS,A.CONFIRMATIONSTATUSREASON,A.CONFIRMATIONSTATUSSUBTYPE,A.COUNTERPARTYACCOUNT,A.COUNTERPARTYACCOUNTNUMBER,A.COUNTERPARTYDESK,A.COUNTERPARTYLEGALENTITY,A.COUNTERPARTYNAME,A.CURRENCY,A.ENTRYDATE,A.EVENTTYPE,A.FIRMROLE,A.LOCATION,A.MASTERCONFAGREEMENTTYPE,A.MASTERAGRRMENTEXTENSION,A.MASTERAGREEMENTMNEMONIC,A.MASTERAGREEMENTSHELF,A.MTMVALUE,A.MTMVALUEDATE,A.NOTIONAL,A.NUMBEROFCONTRACTS,A.OPERATIONFILE,A.PARTYACCOUNT,A.PARTYACCOUNTNUMBER,A.PARTYDESK,A.PARTYLEGALENTITY,A.PARTYPOSITION,A.PARTYRELATIONSHIP,A.PAYSIDECURRENCY,A.PAYSIDENOTIONAL,A.PAYSIDENOTIONALCURRENCY,A.PRIMARYSYSTEM,A.PRIMARYTRANSACTIONID,A.PRODUCTCLASS,A.RECEIVINGSIDECURRENCY,A.RECEIVINGSIDENOTIONAL,A.RECEIVINGSIDENOTIONALCURRENCY,A.SECURITYAGREEMENT,A.SECURITYAGREEMENTSTATUS,A.SETTLEMENTDATE,A.SETTLEMENTMETHOD,A.SALESPERSON,A.STRIKERATE,A.TAXMNEMONIC,A.TERMINATIONDATE,A.ACTUALTERMINATIONDATE,A.TRADEDATE,A.TRADER,A.TRADESTATUS,A.TRADETERMINATIONREASON,A.TYPEOFDEAL,A.EXTERNALSYSTEM,A.EXTERNALTRADENUMBER,A.OWNERSHIP,A.VERBALSTATUS,A.TYPEOFCONFIRM,A.OPERATIONSCENTER,A.CONFIRMATIONSTATUS1,A.DEPOTCORPUNITGFCID,A.FIRMGFPID,A.GFCID,A.CUSTOMERGFPID,A.REFERENCEENTITY,A.MANAGERGROUPNAME,A.CALCULATIONAGENTCITY,A.CUSTOMERREFERENCE,A.ITEMCOUNT,A.UNDERLYINGCUSIP,A.UNDERLYING,A.COBDATE,A.STGYCODE,A.STGY,A.ATTACHMENTPOINTPERCENTAGE,A.EXHAUSTIONPOINTPERCENTAGE,A.CREDITEVENTONTHETRADE,A.OBLIGATIONACCELERATION,A.DOCUMENTATION,A.CONFIRMID,A.PRODUCTTYPE,A.STATE,A.PARENTCOUNTERPARTYNAME,A.PAYSIDEPRINMDL,A.RCVSIDEPRINMDL,A.PAYSIDEPRODCORP,A.RCVSIDEPRODCORP,A.PAYSIDEPRODCLAS,A.RCVSIDEPRODCLAS,A.TYPEOFOPT,A.SUBCLAS,A.STATENUM,A.STATEVERNUM,A.REFERENCESPOTRATE,A.CURRPRDPYMTDT,A.AMENDREASON,A.COB_CURRENCY,A.COB_PAYSIDENOTATIONALCURRENCY,A.COB_RECSIDENOTATIONALCURRENCY,A.FIX_RT,A.MARGININGFREQUENCY,A.TRIGGERAMOUNT,A.MINIUMAMOUNT,A.MTMCURRENCY,A.NETTINGID,A.NETTINGFLAG,A.INITIALMARGIN,A.COLLATERALMARGIN,A.PAY_NOTL_USD,A.RECEIVESIDENOTIONAL,A.CDXTRADETYPE,A.NOTIONALUSD,A.REDID,A.SOURCESYSTEMCODE,A.SOURCEFILEUID,A.CREATEDBY,A.CREATEDTIMESTAMP,A.DERIVEDOWNERSHIPCODE,A.LEGAL_ENTITY_KEY,A.COUNTERPARTY_UNIQUE_ID_GRD,A.LOGICALNAME,A.CEDISPLAYNAME,A.CDSSPREAD,A.SOURCESYSTEM,A.D_ENTRYDATE,A.D_MTMVALUEDATE,A.D_SETTLEMENTDATE,A.D_TERMINATIONDATE,A.D_ACTUALTERMINATIONDATE,A.D_TRADEDATE,A.D_FILE_DATE,A.D_CURPERIODPYMTDT, TAGEBUSINESS,A.TRD_AGEBAND,A.UNIQ_ID,
B.affirmationperson,B.affirmationteam,B.businessline,B.businessunitmanager,B.confirmationstatus,B.confirmationsubstatus,
B.age,B.confirmcategory,B.confirmstatlastmodified,B.confirmstatlastmodifiedby,B.deskname,
B.earlyterminationdate,B.generator,B.generatorteam,B.lasteconomicmodification,B.linkedconfirmed,B.matcher,B.matcherteam,
B.middleofficehead,B.modificationflag,B.previousworkflowstep,B.product,B.productcontroller,B.reconstatus,B.reviewer,B.reviewerteam,
B.sentflag,B.specialhandling,B.stateversionnumber,B.strategy,B.strategycode,B.substrategy,
B.tradingdeskhead,B.workflowstep  ,C.goc
from (select * from DEV_FIN_11_f2 --PARTITION (part_23)
--where ROWID BETWEEN 'AAOWA1AApAAHBqpAAA' AND 'AAOWA1AApAAKn9zAAT'
)  B,
( select --+9PARALLEL
 A.DEAL,A.TRANSACTIONID,A.CREDITDEFAULTSWAPREF,A.CONFIMATIONSTATUS,A.CONFIRMATIONSTATUSREASON,A.CONFIRMATIONSTATUSSUBTYPE,A.COUNTERPARTYACCOUNT,A.COUNTERPARTYACCOUNTNUMBER,A.COUNTERPARTYDESK,A.COUNTERPARTYLEGALENTITY,A.COUNTERPARTYNAME,A.CURRENCY,A.ENTRYDATE,A.EVENTTYPE,A.FIRMROLE,A.LOCATION,A.MASTERCONFAGREEMENTTYPE,A.MASTERAGRRMENTEXTENSION,A.MASTERAGREEMENTMNEMONIC,A.MASTERAGREEMENTSHELF,A.MTMVALUE,A.MTMVALUEDATE,A.NOTIONAL,A.NUMBEROFCONTRACTS,A.OPERATIONFILE,A.PARTYACCOUNT,A.PARTYACCOUNTNUMBER,A.PARTYDESK,A.PARTYLEGALENTITY,A.PARTYPOSITION,A.PARTYRELATIONSHIP,A.PAYSIDECURRENCY,A.PAYSIDENOTIONAL,A.PAYSIDENOTIONALCURRENCY,A.PRIMARYSYSTEM,A.PRIMARYTRANSACTIONID,A.PRODUCTCLASS,A.RECEIVINGSIDECURRENCY,A.RECEIVINGSIDENOTIONAL,A.RECEIVINGSIDENOTIONALCURRENCY,A.SECURITYAGREEMENT,A.SECURITYAGREEMENTSTATUS,A.SETTLEMENTDATE,A.SETTLEMENTMETHOD,A.SALESPERSON,A.STRIKERATE,A.TAXMNEMONIC,A.TERMINATIONDATE,A.ACTUALTERMINATIONDATE,A.TRADEDATE,A.TRADER,A.TRADESTATUS,A.TRADETERMINATIONREASON,A.TYPEOFDEAL,A.EXTERNALSYSTEM,A.EXTERNALTRADENUMBER,A.OWNERSHIP,A.VERBALSTATUS,A.TYPEOFCONFIRM,A.OPERATIONSCENTER,A.CONFIRMATIONSTATUS1,A.DEPOTCORPUNITGFCID,A.FIRMGFPID,A.GFCID,A.CUSTOMERGFPID,A.REFERENCEENTITY,A.MANAGERGROUPNAME,A.CALCULATIONAGENTCITY,A.CUSTOMERREFERENCE,A.ITEMCOUNT,A.UNDERLYINGCUSIP,A.UNDERLYING,A.COBDATE,A.STGYCODE,A.STGY,A.ATTACHMENTPOINTPERCENTAGE,A.EXHAUSTIONPOINTPERCENTAGE,A.CREDITEVENTONTHETRADE,A.OBLIGATIONACCELERATION,A.DOCUMENTATION,A.CONFIRMID,A.PRODUCTTYPE,A.STATE,A.PARENTCOUNTERPARTYNAME,A.PAYSIDEPRINMDL,A.RCVSIDEPRINMDL,A.PAYSIDEPRODCORP,A.RCVSIDEPRODCORP,A.PAYSIDEPRODCLAS,A.RCVSIDEPRODCLAS,A.TYPEOFOPT,A.SUBCLAS,A.STATENUM,A.STATEVERNUM,A.REFERENCESPOTRATE,A.CURRPRDPYMTDT,A.AMENDREASON,A.COB_CURRENCY,A.COB_PAYSIDENOTATIONALCURRENCY,A.COB_RECSIDENOTATIONALCURRENCY,A.FIX_RT,A.MARGININGFREQUENCY,A.TRIGGERAMOUNT,A.MINIUMAMOUNT,A.MTMCURRENCY,A.NETTINGID,A.NETTINGFLAG,A.INITIALMARGIN,A.COLLATERALMARGIN,A.PAY_NOTL_USD,A.RECEIVESIDENOTIONAL,A.CDXTRADETYPE,A.NOTIONALUSD,A.REDID,A.SOURCESYSTEMCODE,A.SOURCEFILEUID,A.CREATEDBY,A.CREATEDTIMESTAMP,A.DERIVEDOWNERSHIPCODE,A.LEGAL_ENTITY_KEY,A.COUNTERPARTY_UNIQUE_ID_GRD,A.LOGICALNAME,A.CEDISPLAYNAME,A.CDSSPREAD,A.SOURCESYSTEM,A.D_ENTRYDATE,A.D_MTMVALUEDATE,A.D_SETTLEMENTDATE,A.D_TERMINATIONDATE,A.D_ACTUALTERMINATIONDATE,A.D_TRADEDATE,A.D_FILE_DATE,A.D_CURPERIODPYMTDT,
   TAGEBUSINESS ,A.TRD_AGEBAND,A.UNIQ_ID
    from STG_OASYS_FEED_f2 --PARTITION (part_23)
    A  --, v_del_trd trd  where  trd.cobdate =A.D_TRADEDATE
) A ,
DEV_XREF C
where A.deal=B.deal (+)
and A.transactionid=B.transactionid (+)
and A.partyaccountnumber =C.firm_acct(+)
	 ;
]]>
      </sql_template>
    </table_utils>
  </exec_query_spool>
</worker1>


</etldataflow>
