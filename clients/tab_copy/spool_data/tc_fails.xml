<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright 2011 . All rights reserved.
     Author: AlexBuzunov@gmail.com (Alex Buzunov)
     Python Implementation of ETL pipeline
-->
<etldataflow name="FAILS">
<globals>

	<!-- PIPELINE execution type
		 SYNC - synchronous, ANYNC - asynchronous 
	-->
	  <param name="FLOW_TYPE" value="SYNC"></param>	

	  <param name="FIELD_TERMINATOR" value="|"></param>
	  <param name="LINE_TERMINATOR" value="''"></param>
	  
  
	  <param name="FROM_DB1" value="%CSMARTBSER_SMARTQ1%"></param>
	  <param name="FROM_DB" value1="%AB_SMARTCOB%" value="%CSMARTBSER_SMARTU1B%" ></param>
	  <param name="FROM_SCHEMA" value="CSMARTBSER"></param>
	  <param name="DB_CONNECTOR" value1="%AB_SMARTCOB%" value="%CSMARTBSER_SMARTU1B%"></param>
	  
	  
	   <!--will spool ALL records if LAME_DUCK=0-->
	  <param name="LAME_DUCK" value='0'></param>
	  <param name="ARRAYSIZE" value="5000"></param>
	  <param name="COPYCOMMIT" value="4"></param>
	  <!--sqlp attribute-->
		
		
	  <param name="SOURCE_FILE" value="--replaced from command line"></param>	
	  <param name="COB_YEAR" value="--replaced from command line"></param>

</globals>


<worker name="FAILS.SPOOL.ALL">
  <exec_query_spool>
    <table_utils 	method="%QUERY_SPOOL_METHOD%" >
     	<param name="IF_COMPRESSED_SPOOL" value="0"></param>
      <sql_template>
        <![CDATA[ 
SELECT --+parallel1
 ROUND(DQCHK_VAL,4) DQCHK_VAL,ROUND(DQCHK_TOT,4) DQCHK_TOT,DRLDWN_CPK1,DRLDWN_CPK2,DRLDWN_CPK3,DRLDWN_CPK4,DRLDWN_CPK5,DRLDWN_CPK6,DRLDWN_CPK7,DRLDWN_CPK8,DRLDWN_CPK9,DRLDWN_CPK10,DQCHK_GEN_VAL1 ,DQCHK_GEN_VAL2 ,DQCHK_GEN_VAL3 ,DQCHK_GEN_VAL4 ,DQCHK_GEN_VAL5 ,DQCHK_GEN_VAL6 ,DQCHK_GEN_VAL7 ,DQCHK_GEN_VAL8 ,DQCHK_GEN_VAL9 ,NULL DQCHK_GEN_VAL10,DQCHK_DATASET_SID , NULL FK_CMT_UNIQ_KEY  FROM ( SELECT
  SUM(ITEMS_AFFECTED) OVER (PARTITION BY FEED_SRC_SYS,SRC_FILE_CD,PRODUCT,MATCH_STATUS,BREAK_DOWN1,BREAK_DOWN2,BREAK_DOWN3,BREAK_DOWN4,BREAK_DOWN5) DQCHK_VAL,
  SUM(TOTAL_ITEMS) OVER (PARTITION BY FEED_SRC_SYS,SRC_FILE_CD,PRODUCT,MATCH_STATUS,BREAK_DOWN1,BREAK_DOWN2,BREAK_DOWN3,BREAK_DOWN4,BREAK_DOWN5) DQCHK_TOT,
  DATSET_METADATA_UID DQCHK_DATASET_SID,
  FEED_SRC_SYS   AS DQCHK_GEN_VAL1,
  SRC_FILE_CD    AS DQCHK_GEN_VAL2,
  PRODUCT AS DQCHK_GEN_VAL3,
  MATCH_STATUS AS DQCHK_GEN_VAL4,
  BREAK_DOWN1 AS DQCHK_GEN_VAL5,
  BREAK_DOWN2 AS DQCHK_GEN_VAL6,
  BREAK_DOWN3 AS DQCHK_GEN_VAL7,
  BREAK_DOWN4 AS DQCHK_GEN_VAL8,
  BREAK_DOWN5 AS DQCHK_GEN_VAL9,
  TOTAL_ITEMS AS DRLDWN_CPK1,
  COB_DATE_ROLLUP_TO   AS DRLDWN_CPK2,
  EXCEPTION_KEY AS DRLDWN_CPK3,
  DIMENSION_KEY AS DRLDWN_CPK4,
  COB_DATE AS DRLDWN_CPK5,
  DRILLDOWN_KEY1 AS DRLDWN_CPK6,
  DRILLDOWN_KEY2 AS DRLDWN_CPK7,
  DRILLDOWN_KEY3 AS DRLDWN_CPK8,
  DRILLDOWN_KEY4 AS DRLDWN_CPK9,
  DRILLDOWN_KEY5 AS DRLDWN_CPK10
FROM
  (
    SELECT
      SUM(ITEM_CNT) TOTAL_ITEMS,
      SUM(
        CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
          THEN ITEM_CNT
          ELSE 0
        END) AS ITEMS_AFFECTED,
      DATSET_METADATA_UID,
      FEED_SRC_SYS,
      SRC_FILE_CD,
      PRODUCT,
      MATCH_STATUS,
      BREAK_DOWN1,
      BREAK_DOWN2,
      BREAK_DOWN3,
      BREAK_DOWN4,
      BREAK_DOWN5,
      COB_DATE_ROLLUP_TO,
      COB_DATE,
      CASE
        WHEN L1_CTGRY IS NOT NULL
        THEN NVL(DIMENSION_KEY,'UNALLOCATED') 
        WHEN  (REF_TBL.REF_KEY IS NULL)
        THEN '#MISSING_REFERENCE_DATA'
        WHEN INCOMPREC_IND = 1
        THEN '#INCOMPLETE_REFERENCE_DATA'
        ELSE NULL
      END AS EXCEPTION_KEY,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DIMENSION_KEY
      END AS DIMENSION_KEY,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY1
      END AS DRILLDOWN_KEY1,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY2
      END AS DRILLDOWN_KEY2,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY3
      END AS DRILLDOWN_KEY3,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY4
      END AS DRILLDOWN_KEY4,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY5
      END AS DRILLDOWN_KEY5
    FROM 
    ( SELECT /*+ PARALLEL (T1,12) FULL(T1) */ ITEM_COUNT AS ITEM_CNT ,
FEED.FEED_SID AS DATSET_METADATA_UID,
SOURCESYSTEM AS FEED_SRC_SYS,
NULL AS SRC_FILE_CD ,
A1.ASET_LVL_0_DESC AS PRODUCT,
NULL AS MATCH_STATUS,
LGL_ENTY_KEY AS DIMENSION_KEY,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        TRUNC(COB_DATE, DECODE(UPPER(NVL('DAY','DAY')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','DAY'))
    ELSE
        TRUNC(COB_DATE, DECODE(UPPER(NVL('WEEK','WEEK')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','WEEK'))
END COB_DATE,
T1.MEASMT_TYP AS BREAK_DOWN1,
T1.METRICS_CATEGORY AS BREAK_DOWN2,
NULL AS BREAK_DOWN3,
NULL AS BREAK_DOWN4,
NULL AS BREAK_DOWN5,
NULL AS DRILLDOWN_KEY1,
NULL AS DRILLDOWN_KEY2,
NULL AS DRILLDOWN_KEY3,
NULL AS DRILLDOWN_KEY4,
NULL AS DRILLDOWN_KEY5,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        UPPER(NVL('DAY','DAY'))
    ELSE
        UPPER(NVL('WEEK','WEEK'))
END COB_DATE_ROLLUP_TO
 FROM (v_frh_11_12_13)  T1,
 ( select ASET_LVL_KEY ASET_LVL_KEY1, ASET_LVL_0_DESC FROM csmartref.MAN_REF_ASET_LVL_DATA) A1,
(Select FEED_SID,SRC_FILE_CD  from CSMARTREF.SMART_ETL_FEED_MSTR FEED WHERE STRM_SID =6 ) FEED WHERE T1.ASET_CLAS_KEY = A1.ASET_LVL_KEY1 (+)
AND upper('FAILS_' ||
DECODE(T1.SOURCESYSTEM ,'IOWAAU','IOWA_AU',T1.SOURCESYSTEM) ) = upper(FEED.SRC_FILE_CD (+))
AND SOURCESYSTEM NOT IN ( 'OASYSEF','CLU' )
        AND METRICS_CATEGORY    = 'FAIL'
        AND FAIL_INDICATOR      ='Y'
AND COB_DATE  >= TO_DATE(NVL('01-JAN-11','23-FEB-2013'))
AND  COB_DATE  <= TO_DATE(NVL('23-FEB-13','23-FEB-2013')) ) FACT_TBL,
    ( SELECT
            CASE
                WHEN MAN_REF_LGL_ENTY_DATA.LGL_ENTY_ID IS NULL
                THEN 1
                ELSE 0
            END AS INCOMPREC_IND,
            MAN_REF_LGL_ENTY_XREF.LGL_ENTY_KEY REF_KEY
        FROM csmartref.MAN_REF_LGL_ENTY_XREF,
            csmartref.MAN_REF_LGL_ENTY_DATA
        WHERE MAN_REF_LGL_ENTY_DATA.LGL_ENTY_ID(+) =MAN_REF_LGL_ENTY_XREF.LGL_ENTY_ID ) REF_TBL ,
    ( SELECT
            L0_CTGRY,
            L1_CTGRY,
            STAT_KEY_VAL
        FROM DQSMART.MAN_REF_STATIC_KEYS_TEMP) STATIC_KEYS_TBL
     WHERE FACT_TBL.DIMENSION_KEY =REF_TBL.REF_KEY(+)
     AND NVL(FACT_TBL.DIMENSION_KEY,'UNALLOCATED') =STATIC_KEYS_TBL.STAT_KEY_VAL(+)
 GROUP BY
      DATSET_METADATA_UID,
      FEED_SRC_SYS,
      SRC_FILE_CD,
      PRODUCT,
      MATCH_STATUS,
      BREAK_DOWN1,
      BREAK_DOWN2,
      BREAK_DOWN3,
      BREAK_DOWN4,
      BREAK_DOWN5,
      COB_DATE_ROLLUP_TO,
      CASE
        WHEN L1_CTGRY IS NOT NULL
        THEN NVL(DIMENSION_KEY,'UNALLOCATED') 
        WHEN  (REF_TBL.REF_KEY IS NULL)
        THEN '#MISSING_REFERENCE_DATA'
        WHEN INCOMPREC_IND = 1
        THEN '#INCOMPLETE_REFERENCE_DATA'
        ELSE NULL
      END ,
      COB_DATE,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DIMENSION_KEY
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY1
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY2
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY3
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY4
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY5
      END 
  ) );
]]>
      </sql_template>
    </table_utils>
  </exec_query_spool>
</worker>

<worker1 name="FAILS.SPOOL.ALL">
  <exec_query_spool>
    <table_utils 	method="%QUERY_SPOOL_METHOD%" >
     	<param name="IF_COMPRESSED_SPOOL" value="0"></param>
      <sql_template>
        <![CDATA[ 
SELECT --+parallel1
 ROUND(DQCHK_VAL,4) DQCHK_VAL,ROUND(DQCHK_TOT,4) DQCHK_TOT,DRLDWN_CPK1,DRLDWN_CPK2,DRLDWN_CPK3,DRLDWN_CPK4,DRLDWN_CPK5,DRLDWN_CPK6,DRLDWN_CPK7,DRLDWN_CPK8,DRLDWN_CPK9,DRLDWN_CPK10,DQCHK_GEN_VAL1 ,DQCHK_GEN_VAL2 ,DQCHK_GEN_VAL3 ,DQCHK_GEN_VAL4 ,DQCHK_GEN_VAL5 ,DQCHK_GEN_VAL6 ,DQCHK_GEN_VAL7 ,DQCHK_GEN_VAL8 ,DQCHK_GEN_VAL9 ,NULL DQCHK_GEN_VAL10,DQCHK_DATASET_SID , NULL FK_CMT_UNIQ_KEY  FROM ( SELECT
  SUM(ITEMS_AFFECTED) OVER (PARTITION BY FEED_SRC_SYS,SRC_FILE_CD,PRODUCT,MATCH_STATUS,BREAK_DOWN1,BREAK_DOWN2,BREAK_DOWN3,BREAK_DOWN4,BREAK_DOWN5) DQCHK_VAL,
  SUM(TOTAL_ITEMS) OVER (PARTITION BY FEED_SRC_SYS,SRC_FILE_CD,PRODUCT,MATCH_STATUS,BREAK_DOWN1,BREAK_DOWN2,BREAK_DOWN3,BREAK_DOWN4,BREAK_DOWN5) DQCHK_TOT,
  DATSET_METADATA_UID DQCHK_DATASET_SID,
  FEED_SRC_SYS   AS DQCHK_GEN_VAL1,
  SRC_FILE_CD    AS DQCHK_GEN_VAL2,
  PRODUCT AS DQCHK_GEN_VAL3,
  MATCH_STATUS AS DQCHK_GEN_VAL4,
  BREAK_DOWN1 AS DQCHK_GEN_VAL5,
  BREAK_DOWN2 AS DQCHK_GEN_VAL6,
  BREAK_DOWN3 AS DQCHK_GEN_VAL7,
  BREAK_DOWN4 AS DQCHK_GEN_VAL8,
  BREAK_DOWN5 AS DQCHK_GEN_VAL9,
  TOTAL_ITEMS AS DRLDWN_CPK1,
  COB_DATE_ROLLUP_TO   AS DRLDWN_CPK2,
  EXCEPTION_KEY AS DRLDWN_CPK3,
  DIMENSION_KEY AS DRLDWN_CPK4,
  COB_DATE AS DRLDWN_CPK5,
  DRILLDOWN_KEY1 AS DRLDWN_CPK6,
  DRILLDOWN_KEY2 AS DRLDWN_CPK7,
  DRILLDOWN_KEY3 AS DRLDWN_CPK8,
  DRILLDOWN_KEY4 AS DRLDWN_CPK9,
  DRILLDOWN_KEY5 AS DRLDWN_CPK10
FROM
  (
    SELECT
      SUM(ITEM_CNT) TOTAL_ITEMS,
      SUM(
        CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
          THEN ITEM_CNT
          ELSE 0
        END) AS ITEMS_AFFECTED,
      DATSET_METADATA_UID,
      FEED_SRC_SYS,
      SRC_FILE_CD,
      PRODUCT,
      MATCH_STATUS,
      BREAK_DOWN1,
      BREAK_DOWN2,
      BREAK_DOWN3,
      BREAK_DOWN4,
      BREAK_DOWN5,
      COB_DATE_ROLLUP_TO,
      COB_DATE,
      CASE
        WHEN L1_CTGRY IS NOT NULL
        THEN NVL(DIMENSION_KEY,'UNALLOCATED') 
        WHEN  (REF_TBL.REF_KEY IS NULL)
        THEN '#MISSING_REFERENCE_DATA'
        WHEN INCOMPREC_IND = 1
        THEN '#INCOMPLETE_REFERENCE_DATA'
        ELSE NULL
      END AS EXCEPTION_KEY,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DIMENSION_KEY
      END AS DIMENSION_KEY,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY1
      END AS DRILLDOWN_KEY1,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY2
      END AS DRILLDOWN_KEY2,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY3
      END AS DRILLDOWN_KEY3,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY4
      END AS DRILLDOWN_KEY4,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY5
      END AS DRILLDOWN_KEY5
    FROM 
    ( SELECT /*+ PARALLEL (T1,12) FULL(T1) */ ITEM_COUNT AS ITEM_CNT ,
FEED.FEED_SID AS DATSET_METADATA_UID,
SOURCESYSTEM AS FEED_SRC_SYS,
NULL AS SRC_FILE_CD ,
A1.ASET_LVL_0_DESC AS PRODUCT,
NULL AS MATCH_STATUS,
LGL_ENTY_KEY AS DIMENSION_KEY,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        TRUNC(COB_DATE, DECODE(UPPER(NVL('DAY','DAY')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','DAY'))
    ELSE
        TRUNC(COB_DATE, DECODE(UPPER(NVL('WEEK','WEEK')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','WEEK'))
END COB_DATE,
T1.MEASMT_TYP AS BREAK_DOWN1,
T1.METRICS_CATEGORY AS BREAK_DOWN2,
NULL AS BREAK_DOWN3,
NULL AS BREAK_DOWN4,
NULL AS BREAK_DOWN5,
NULL AS DRILLDOWN_KEY1,
NULL AS DRILLDOWN_KEY2,
NULL AS DRILLDOWN_KEY3,
NULL AS DRILLDOWN_KEY4,
NULL AS DRILLDOWN_KEY5,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        UPPER(NVL('DAY','DAY'))
    ELSE
        UPPER(NVL('WEEK','WEEK'))
END COB_DATE_ROLLUP_TO
 FROM (select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110103) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110104) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110105) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110106) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110107) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110108) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110109) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110110) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110111) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110112) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110113) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110114) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110115) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110116) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110117) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110118) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110119) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110120) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110121) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110122) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110123) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110124) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110125) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110126) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110127) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110128) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110129) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110130) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110131) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110201) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110202) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110203) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110204) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110205) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110206) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110207) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110208) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110209) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110210) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110211) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110212) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110213) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110214) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110215) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110216) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110217) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110218) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110219) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110220) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110221) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110222) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110223) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110224) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110225) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110226) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110227) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110228) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110301) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110302) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110303) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110304) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110305) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110306) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110307) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110308) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110309) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110310) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110311) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110312) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110313) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110314) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110315) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110316) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110317) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110318) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110319) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110320) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110321) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110322) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110323) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110324) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110325) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110326) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110327) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110328) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110329) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110330) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110331) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110401) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110402) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110403) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110404) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110405) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110406) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110407) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110408) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110409) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110410) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110411) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110412) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110413) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110414) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110415) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110416) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110417) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110418) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110419) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110420) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110421) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110422) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110423) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110424) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110425) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110426) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110427) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110428) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110429) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110430) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110501) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110502) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110503) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110504) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110505) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110506) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110507) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110508) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110509) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110510) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110511) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110512) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110513) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110514) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110515) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110516) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110517) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110518) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110519) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110520) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110521) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110522) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110523) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110524) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110525) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110526) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110527) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110528) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110529) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110530) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110531) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110601) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110602) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110603) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110604) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110605) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110606) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110607) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110608) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110609) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110610) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110611) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110612) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110613) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110614) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110615) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110616) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110617) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110618) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110619) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110620) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110621) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110622) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110623) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110624) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110625) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110626) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110627) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110628) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110629) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110630) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110701) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110702) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110703) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110704) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110705) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110706) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110707) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110708) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110709) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110710) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110711) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110712) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110713) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110714) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110715) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110716) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110717) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110718) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110719) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110720) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110721) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110722) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110723) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110724) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110725) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110726) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110727) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110728) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110729) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110730) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110731) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110801) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110802) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110803) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110804) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110805) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110806) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110807) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110808) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110809) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110810) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110811) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110812) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110813) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110814) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110815) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110816) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110817) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110818) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110819) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110820) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110821) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110822) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110823) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110824) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110825) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110826) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110827) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110828) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110829) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110830) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110831) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110901) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110902) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110903) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110904) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110905) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110906) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110907) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110908) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110909) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110910) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110911) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110912) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110913) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110914) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110915) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110916) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110917) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110918) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110919) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110920) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110921) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110922) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110923) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110924) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110925) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110926) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110927) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110928) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110929) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110930) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111001) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111002) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111003) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111004) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111005) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111006) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111007) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111008) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111009) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111010) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111011) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111012) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111013) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111014) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111015) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111016) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111017) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111018) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111019) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111020) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111021) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111022) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111023) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111024) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111025) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111026) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111027) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111028) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111029) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111030) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111031) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111103) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111104) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111105) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111106) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111107) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111108) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111109) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111110) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111111) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111112) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111113) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111114) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111115) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111116) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111117) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111118) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111119) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111120) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111121) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111122) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111123) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111124) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111125) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111126) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111127) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111128) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111129) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111130) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111201) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111202) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111203) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111204) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111205) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111206) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111207) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111208) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111209) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111210) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111211) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111212) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111213) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111214) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111215) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111216) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111217) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111218) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111219) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111220) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111221) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111222) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111223) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111224) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111225) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111226) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111227) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111228) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111229) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111230) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111231) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120103) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120104) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120105) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120106) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120107) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120108) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120109) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120110) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120111) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120112) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120113) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120114) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120115) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120116) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120117) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120118) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120119) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120120) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120121) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120122) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120123) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120124) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120125) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120126) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120127) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120128) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120129) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120130) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120131) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120201) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120202) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120203) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120204) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120205) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120206) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120207) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120208) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120209) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120210) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120211) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120212) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120213) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120214) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120215) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120216) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120217) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120218) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120219) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120220) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120221) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120222) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120223) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120224) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120225) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120226) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120227) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120228) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120229) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120301) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120302) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120303) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120304) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120305) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120306) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120307) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120308) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120309) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120310) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120311) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120312) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120313) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120314) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120315) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120316) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120317) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120318) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120319) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120320) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120321) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120322) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120323) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120324) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120325) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120326) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120327) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120328) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120329) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120330) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120331) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120401) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120402) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120403) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120404) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120405) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120406) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120407) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120408) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120409) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120410) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120411) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120412) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120413) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120414) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120415) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120416) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120417) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120418) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120419) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120420) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120421) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120422) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120423) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120424) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120425) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120426) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120427) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120428) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120429) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120430) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120501) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120502) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120503) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120504) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120505) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120506) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120507) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120508) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120509) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120510) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120511) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120512) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120513) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120514) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120515) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120516) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120517) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120518) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120519) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120520) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120521) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120522) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120523) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120524) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120525) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120526) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120527) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120528) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120529) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120530) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120531) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120601) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120602) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120603) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120604) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120605) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120606) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120607) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120608) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120609) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120610) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120611) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120612) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120613) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120614) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120615) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120616) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120617) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120618) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120619) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120620) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120621) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120622) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120623) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120624) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120625) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120626) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120627) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120628) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120629) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120630) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120701) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120702) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120703) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120704) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120705) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120706) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120707) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120708) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120709) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120710) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120711) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120712) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120713) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120714) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120715) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120716) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120717) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120718) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120719) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120720) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120721) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120722) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120723) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120724) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120725) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120726) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120727) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120728) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120729) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120730) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120731) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120801) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120802) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120803) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120804) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120805) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120806) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120807) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120808) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120809) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120810) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120811) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120812) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120813) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120814) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120815) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120816) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120817) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120818) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120819) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120820) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120821) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120822) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120823) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120824) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120825) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120826) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120827) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120828) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120829) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120830) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120831) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120901) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120902) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120903) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120904) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120905) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120906) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120907) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120908) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120909) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120910) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120911) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120912) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120913) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120914) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120915) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120916) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120917) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120918) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120919) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120920) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120921) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120922) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120923) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120924) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120925) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120926) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120927) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120928) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120929) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120930) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121001) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121002) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121003) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121004) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121005) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121006) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121007) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121008) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121009) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121010) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121011) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121012) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121013) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121014) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121015) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121016) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121017) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121018) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121019) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121020) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121021) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121022) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121023) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121024) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121025) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121026) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121027) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121028) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121029) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121030) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121031) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121103) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121104) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121105) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121106) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121107) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121108) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121109) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121110) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121111) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121112) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121113) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121114) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121115) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121116) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121117) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121118) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121119) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121120) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121121) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121122) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121123) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121124) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121125) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121126) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121127) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121128) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121129) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121130) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121201) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121202) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121203) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121204) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121205) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121206) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121207) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121208) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121209) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121210) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121211) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121212) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121213) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121214) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121215) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121216) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121217) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121218) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121219) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121220) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121221) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121222) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121223) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121224) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121225) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121226) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121227) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121228) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121229) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121230) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121231) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130103) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130104) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130105) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130106) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130107) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130108) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130109) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130110) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130111) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130112) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130113) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130114) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130115) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130116) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130117) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130118) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130119) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130120) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130121) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130122) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130123) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130124) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130125) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130126) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130127) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130128) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130129) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130130) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130131) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130201) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130202) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130203) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130204) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130205) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130206) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130207) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130208) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130209) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130210) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130211) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130212) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130213) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130214) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130215) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130216) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130217) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130218) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130219) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130220) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130221) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130222) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130223) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130224) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130225) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130226) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130227) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130228) )  T1,
 ( select ASET_LVL_KEY ASET_LVL_KEY1, ASET_LVL_0_DESC FROM csmartref.MAN_REF_ASET_LVL_DATA) A1,
(Select FEED_SID,SRC_FILE_CD  from CSMARTREF.SMART_ETL_FEED_MSTR FEED WHERE STRM_SID =6 ) FEED WHERE T1.ASET_CLAS_KEY = A1.ASET_LVL_KEY1 (+)
AND upper('FAILS_' ||
DECODE(T1.SOURCESYSTEM ,'IOWAAU','IOWA_AU',T1.SOURCESYSTEM) ) = upper(FEED.SRC_FILE_CD (+))
AND SOURCESYSTEM NOT IN ( 'OASYSEF','CLU' )
        AND METRICS_CATEGORY    = 'FAIL'
        AND FAIL_INDICATOR      ='Y'
AND COB_DATE  >= TO_DATE(NVL('01-JAN-11','23-FEB-2013'))
AND  COB_DATE  <= TO_DATE(NVL('23-FEB-13','23-FEB-2013')) ) FACT_TBL,
    ( SELECT
            CASE
                WHEN MAN_REF_LGL_ENTY_DATA.LGL_ENTY_ID IS NULL
                THEN 1
                ELSE 0
            END AS INCOMPREC_IND,
            MAN_REF_LGL_ENTY_XREF.LGL_ENTY_KEY REF_KEY
        FROM csmartref.MAN_REF_LGL_ENTY_XREF,
            csmartref.MAN_REF_LGL_ENTY_DATA
        WHERE MAN_REF_LGL_ENTY_DATA.LGL_ENTY_ID(+) =MAN_REF_LGL_ENTY_XREF.LGL_ENTY_ID ) REF_TBL ,
    ( SELECT
            L0_CTGRY,
            L1_CTGRY,
            STAT_KEY_VAL
        FROM DQSMART.MAN_REF_STATIC_KEYS_TEMP) STATIC_KEYS_TBL
     WHERE FACT_TBL.DIMENSION_KEY =REF_TBL.REF_KEY(+)
     AND NVL(FACT_TBL.DIMENSION_KEY,'UNALLOCATED') =STATIC_KEYS_TBL.STAT_KEY_VAL(+)
 GROUP BY
      DATSET_METADATA_UID,
      FEED_SRC_SYS,
      SRC_FILE_CD,
      PRODUCT,
      MATCH_STATUS,
      BREAK_DOWN1,
      BREAK_DOWN2,
      BREAK_DOWN3,
      BREAK_DOWN4,
      BREAK_DOWN5,
      COB_DATE_ROLLUP_TO,
      CASE
        WHEN L1_CTGRY IS NOT NULL
        THEN NVL(DIMENSION_KEY,'UNALLOCATED') 
        WHEN  (REF_TBL.REF_KEY IS NULL)
        THEN '#MISSING_REFERENCE_DATA'
        WHEN INCOMPREC_IND = 1
        THEN '#INCOMPLETE_REFERENCE_DATA'
        ELSE NULL
      END ,
      COB_DATE,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DIMENSION_KEY
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY1
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY2
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY3
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY4
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY5
      END 
  ) );
]]>
      </sql_template>
    </table_utils>
  </exec_query_spool>
</worker1>

<worker1 name="FAILS.SPOOL.2011">
  <exec_query_spool>
    <table_utils 	method="%QUERY_SPOOL_METHOD%" >
     	<param name="IF_COMPRESSED_SPOOL" value="0"></param>
      <sql_template>
        <![CDATA[ 
SELECT --+parallel1
 ROUND(DQCHK_VAL,4) DQCHK_VAL,ROUND(DQCHK_TOT,4) DQCHK_TOT,DRLDWN_CPK1,DRLDWN_CPK2,DRLDWN_CPK3,DRLDWN_CPK4,DRLDWN_CPK5,DRLDWN_CPK6,DRLDWN_CPK7,DRLDWN_CPK8,DRLDWN_CPK9,DRLDWN_CPK10,DQCHK_GEN_VAL1 ,DQCHK_GEN_VAL2 ,DQCHK_GEN_VAL3 ,DQCHK_GEN_VAL4 ,DQCHK_GEN_VAL5 ,DQCHK_GEN_VAL6 ,DQCHK_GEN_VAL7 ,DQCHK_GEN_VAL8 ,DQCHK_GEN_VAL9 ,NULL DQCHK_GEN_VAL10,DQCHK_DATASET_SID , NULL FK_CMT_UNIQ_KEY  FROM ( SELECT
  SUM(ITEMS_AFFECTED) OVER (PARTITION BY FEED_SRC_SYS,SRC_FILE_CD,PRODUCT,MATCH_STATUS,BREAK_DOWN1,BREAK_DOWN2,BREAK_DOWN3,BREAK_DOWN4,BREAK_DOWN5) DQCHK_VAL,
  SUM(TOTAL_ITEMS) OVER (PARTITION BY FEED_SRC_SYS,SRC_FILE_CD,PRODUCT,MATCH_STATUS,BREAK_DOWN1,BREAK_DOWN2,BREAK_DOWN3,BREAK_DOWN4,BREAK_DOWN5) DQCHK_TOT,
  DATSET_METADATA_UID DQCHK_DATASET_SID,
  FEED_SRC_SYS   AS DQCHK_GEN_VAL1,
  SRC_FILE_CD    AS DQCHK_GEN_VAL2,
  PRODUCT AS DQCHK_GEN_VAL3,
  MATCH_STATUS AS DQCHK_GEN_VAL4,
  BREAK_DOWN1 AS DQCHK_GEN_VAL5,
  BREAK_DOWN2 AS DQCHK_GEN_VAL6,
  BREAK_DOWN3 AS DQCHK_GEN_VAL7,
  BREAK_DOWN4 AS DQCHK_GEN_VAL8,
  BREAK_DOWN5 AS DQCHK_GEN_VAL9,
  TOTAL_ITEMS AS DRLDWN_CPK1,
  COB_DATE_ROLLUP_TO   AS DRLDWN_CPK2,
  EXCEPTION_KEY AS DRLDWN_CPK3,
  DIMENSION_KEY AS DRLDWN_CPK4,
  COB_DATE AS DRLDWN_CPK5,
  DRILLDOWN_KEY1 AS DRLDWN_CPK6,
  DRILLDOWN_KEY2 AS DRLDWN_CPK7,
  DRILLDOWN_KEY3 AS DRLDWN_CPK8,
  DRILLDOWN_KEY4 AS DRLDWN_CPK9,
  DRILLDOWN_KEY5 AS DRLDWN_CPK10
FROM
  (
    SELECT
      SUM(ITEM_CNT) TOTAL_ITEMS,
      SUM(
        CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
          THEN ITEM_CNT
          ELSE 0
        END) AS ITEMS_AFFECTED,
      DATSET_METADATA_UID,
      FEED_SRC_SYS,
      SRC_FILE_CD,
      PRODUCT,
      MATCH_STATUS,
      BREAK_DOWN1,
      BREAK_DOWN2,
      BREAK_DOWN3,
      BREAK_DOWN4,
      BREAK_DOWN5,
      COB_DATE_ROLLUP_TO,
      COB_DATE,
      CASE
        WHEN L1_CTGRY IS NOT NULL
        THEN NVL(DIMENSION_KEY,'UNALLOCATED') 
        WHEN  (REF_TBL.REF_KEY IS NULL)
        THEN '#MISSING_REFERENCE_DATA'
        WHEN INCOMPREC_IND = 1
        THEN '#INCOMPLETE_REFERENCE_DATA'
        ELSE NULL
      END AS EXCEPTION_KEY,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DIMENSION_KEY
      END AS DIMENSION_KEY,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY1
      END AS DRILLDOWN_KEY1,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY2
      END AS DRILLDOWN_KEY2,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY3
      END AS DRILLDOWN_KEY3,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY4
      END AS DRILLDOWN_KEY4,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY5
      END AS DRILLDOWN_KEY5
    FROM 
    ( SELECT /*+ PARALLEL (T1,12) FULL(T1) */ ITEM_COUNT AS ITEM_CNT ,
FEED.FEED_SID AS DATSET_METADATA_UID,
SOURCESYSTEM AS FEED_SRC_SYS,
NULL AS SRC_FILE_CD ,
A1.ASET_LVL_0_DESC AS PRODUCT,
NULL AS MATCH_STATUS,
LGL_ENTY_KEY AS DIMENSION_KEY,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        TRUNC(COB_DATE, DECODE(UPPER(NVL('DAY','DAY')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','DAY'))
    ELSE
        TRUNC(COB_DATE, DECODE(UPPER(NVL('WEEK','WEEK')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','WEEK'))
END COB_DATE,
T1.MEASMT_TYP AS BREAK_DOWN1,
T1.METRICS_CATEGORY AS BREAK_DOWN2,
NULL AS BREAK_DOWN3,
NULL AS BREAK_DOWN4,
NULL AS BREAK_DOWN5,
NULL AS DRILLDOWN_KEY1,
NULL AS DRILLDOWN_KEY2,
NULL AS DRILLDOWN_KEY3,
NULL AS DRILLDOWN_KEY4,
NULL AS DRILLDOWN_KEY5,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        UPPER(NVL('DAY','DAY'))
    ELSE
        UPPER(NVL('WEEK','WEEK'))
END COB_DATE_ROLLUP_TO
 FROM (select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110103) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110104) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110105) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110106) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110107) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110108) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110109) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110110) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110111) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110112) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110113) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110114) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110115) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110116) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110117) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110118) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110119) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110120) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110121) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110122) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110123) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110124) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110125) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110126) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110127) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110128) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110129) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110130) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110131) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110201) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110202) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110203) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110204) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110205) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110206) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110207) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110208) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110209) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110210) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110211) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110212) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110213) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110214) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110215) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110216) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110217) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110218) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110219) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110220) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110221) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110222) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110223) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110224) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110225) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110226) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110227) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110228) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110301) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110302) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110303) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110304) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110305) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110306) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110307) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110308) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110309) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110310) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110311) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110312) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110313) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110314) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110315) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110316) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110317) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110318) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110319) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110320) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110321) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110322) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110323) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110324) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110325) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110326) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110327) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110328) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110329) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110330) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110331) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110401) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110402) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110403) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110404) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110405) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110406) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110407) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110408) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110409) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110410) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110411) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110412) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110413) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110414) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110415) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110416) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110417) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110418) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110419) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110420) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110421) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110422) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110423) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110424) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110425) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110426) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110427) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110428) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110429) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110430) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110501) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110502) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110503) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110504) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110505) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110506) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110507) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110508) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110509) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110510) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110511) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110512) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110513) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110514) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110515) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110516) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110517) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110518) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110519) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110520) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110521) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110522) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110523) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110524) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110525) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110526) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110527) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110528) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110529) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110530) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110531) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110601) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110602) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110603) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110604) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110605) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110606) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110607) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110608) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110609) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110610) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110611) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110612) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110613) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110614) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110615) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110616) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110617) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110618) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110619) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110620) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110621) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110622) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110623) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110624) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110625) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110626) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110627) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110628) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110629) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110630) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110701) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110702) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110703) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110704) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110705) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110706) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110707) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110708) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110709) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110710) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110711) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110712) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110713) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110714) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110715) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110716) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110717) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110718) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110719) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110720) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110721) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110722) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110723) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110724) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110725) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110726) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110727) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110728) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110729) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110730) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110731) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110801) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110802) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110803) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110804) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110805) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110806) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110807) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110808) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110809) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110810) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110811) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110812) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110813) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110814) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110815) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110816) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110817) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110818) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110819) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110820) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110821) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110822) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110823) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110824) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110825) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110826) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110827) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110828) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110829) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110830) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110831) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110901) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110902) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110903) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110904) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110905) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110906) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110907) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110908) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110909) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110910) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110911) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110912) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110913) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110914) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110915) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110916) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110917) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110918) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110919) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110920) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110921) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110922) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110923) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110924) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110925) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110926) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110927) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110928) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110929) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110930) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111001) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111002) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111003) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111004) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111005) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111006) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111007) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111008) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111009) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111010) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111011) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111012) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111013) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111014) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111015) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111016) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111017) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111018) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111019) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111020) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111021) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111022) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111023) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111024) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111025) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111026) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111027) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111028) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111029) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111030) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111031) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111103) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111104) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111105) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111106) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111107) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111108) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111109) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111110) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111111) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111112) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111113) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111114) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111115) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111116) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111117) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111118) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111119) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111120) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111121) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111122) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111123) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111124) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111125) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111126) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111127) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111128) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111129) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111130) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111201) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111202) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111203) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111204) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111205) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111206) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111207) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111208) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111209) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111210) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111211) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111212) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111213) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111214) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111215) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111216) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111217) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111218) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111219) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111220) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111221) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111222) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111223) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111224) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111225) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111226) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111227) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111228) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111229) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111230) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111231)  )  T1,
 ( select ASET_LVL_KEY ASET_LVL_KEY1, ASET_LVL_0_DESC FROM csmartref.MAN_REF_ASET_LVL_DATA) A1,
(Select FEED_SID,SRC_FILE_CD  from CSMARTREF.SMART_ETL_FEED_MSTR FEED WHERE STRM_SID =6 ) FEED WHERE T1.ASET_CLAS_KEY = A1.ASET_LVL_KEY1 (+)
AND upper('FAILS_' ||
DECODE(T1.SOURCESYSTEM ,'IOWAAU','IOWA_AU',T1.SOURCESYSTEM) ) = upper(FEED.SRC_FILE_CD (+))
AND SOURCESYSTEM NOT IN ( 'OASYSEF','CLU' )
        AND METRICS_CATEGORY    = 'FAIL'
        AND FAIL_INDICATOR      ='Y'
AND COB_DATE  >= TO_DATE(NVL('01-JAN-11','23-FEB-2013'))
AND  COB_DATE  <= TO_DATE(NVL('23-FEB-13','23-FEB-2013')) ) FACT_TBL,
    ( SELECT
            CASE
                WHEN MAN_REF_LGL_ENTY_DATA.LGL_ENTY_ID IS NULL
                THEN 1
                ELSE 0
            END AS INCOMPREC_IND,
            MAN_REF_LGL_ENTY_XREF.LGL_ENTY_KEY REF_KEY
        FROM csmartref.MAN_REF_LGL_ENTY_XREF,
            csmartref.MAN_REF_LGL_ENTY_DATA
        WHERE MAN_REF_LGL_ENTY_DATA.LGL_ENTY_ID(+) =MAN_REF_LGL_ENTY_XREF.LGL_ENTY_ID ) REF_TBL ,
    ( SELECT
            L0_CTGRY,
            L1_CTGRY,
            STAT_KEY_VAL
        FROM DQSMART.MAN_REF_STATIC_KEYS_TEMP) STATIC_KEYS_TBL
     WHERE FACT_TBL.DIMENSION_KEY =REF_TBL.REF_KEY(+)
     AND NVL(FACT_TBL.DIMENSION_KEY,'UNALLOCATED') =STATIC_KEYS_TBL.STAT_KEY_VAL(+)
 GROUP BY
      DATSET_METADATA_UID,
      FEED_SRC_SYS,
      SRC_FILE_CD,
      PRODUCT,
      MATCH_STATUS,
      BREAK_DOWN1,
      BREAK_DOWN2,
      BREAK_DOWN3,
      BREAK_DOWN4,
      BREAK_DOWN5,
      COB_DATE_ROLLUP_TO,
      CASE
        WHEN L1_CTGRY IS NOT NULL
        THEN NVL(DIMENSION_KEY,'UNALLOCATED') 
        WHEN  (REF_TBL.REF_KEY IS NULL)
        THEN '#MISSING_REFERENCE_DATA'
        WHEN INCOMPREC_IND = 1
        THEN '#INCOMPLETE_REFERENCE_DATA'
        ELSE NULL
      END ,
      COB_DATE,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DIMENSION_KEY
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY1
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY2
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY3
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY4
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY5
      END 
  ) );
]]>
      </sql_template>
    </table_utils>
  </exec_query_spool>
</worker1>

<worker1 name="FAILS.SPOOL.2012">
  <exec_query_spool>
    <table_utils 	method="%QUERY_SPOOL_METHOD%" >
     	<param name="IF_COMPRESSED_SPOOL" value="0"></param>
      <sql_template>
        <![CDATA[ 
SELECT 
 ROUND(DQCHK_VAL,4) DQCHK_VAL,ROUND(DQCHK_TOT,4) DQCHK_TOT,DRLDWN_CPK1,DRLDWN_CPK2,DRLDWN_CPK3,DRLDWN_CPK4,DRLDWN_CPK5,DRLDWN_CPK6,DRLDWN_CPK7,DRLDWN_CPK8,DRLDWN_CPK9,DRLDWN_CPK10,DQCHK_GEN_VAL1 ,DQCHK_GEN_VAL2 ,DQCHK_GEN_VAL3 ,DQCHK_GEN_VAL4 ,DQCHK_GEN_VAL5 ,DQCHK_GEN_VAL6 ,DQCHK_GEN_VAL7 ,DQCHK_GEN_VAL8 ,DQCHK_GEN_VAL9 ,NULL DQCHK_GEN_VAL10,DQCHK_DATASET_SID , NULL FK_CMT_UNIQ_KEY  FROM ( SELECT
  SUM(ITEMS_AFFECTED) OVER (PARTITION BY FEED_SRC_SYS,SRC_FILE_CD,PRODUCT,MATCH_STATUS,BREAK_DOWN1,BREAK_DOWN2,BREAK_DOWN3,BREAK_DOWN4,BREAK_DOWN5) DQCHK_VAL,
  SUM(TOTAL_ITEMS) OVER (PARTITION BY FEED_SRC_SYS,SRC_FILE_CD,PRODUCT,MATCH_STATUS,BREAK_DOWN1,BREAK_DOWN2,BREAK_DOWN3,BREAK_DOWN4,BREAK_DOWN5) DQCHK_TOT,
  DATSET_METADATA_UID DQCHK_DATASET_SID,
  FEED_SRC_SYS   AS DQCHK_GEN_VAL1,
  SRC_FILE_CD    AS DQCHK_GEN_VAL2,
  PRODUCT AS DQCHK_GEN_VAL3,
  MATCH_STATUS AS DQCHK_GEN_VAL4,
  BREAK_DOWN1 AS DQCHK_GEN_VAL5,
  BREAK_DOWN2 AS DQCHK_GEN_VAL6,
  BREAK_DOWN3 AS DQCHK_GEN_VAL7,
  BREAK_DOWN4 AS DQCHK_GEN_VAL8,
  BREAK_DOWN5 AS DQCHK_GEN_VAL9,
  TOTAL_ITEMS AS DRLDWN_CPK1,
  COB_DATE_ROLLUP_TO   AS DRLDWN_CPK2,
  EXCEPTION_KEY AS DRLDWN_CPK3,
  DIMENSION_KEY AS DRLDWN_CPK4,
  COB_DATE AS DRLDWN_CPK5,
  DRILLDOWN_KEY1 AS DRLDWN_CPK6,
  DRILLDOWN_KEY2 AS DRLDWN_CPK7,
  DRILLDOWN_KEY3 AS DRLDWN_CPK8,
  DRILLDOWN_KEY4 AS DRLDWN_CPK9,
  DRILLDOWN_KEY5 AS DRLDWN_CPK10
FROM
  (
    SELECT
      SUM(ITEM_CNT) TOTAL_ITEMS,
      SUM(
        CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
          THEN ITEM_CNT
          ELSE 0
        END) AS ITEMS_AFFECTED,
      DATSET_METADATA_UID,
      FEED_SRC_SYS,
      SRC_FILE_CD,
      PRODUCT,
      MATCH_STATUS,
      BREAK_DOWN1,
      BREAK_DOWN2,
      BREAK_DOWN3,
      BREAK_DOWN4,
      BREAK_DOWN5,
      COB_DATE_ROLLUP_TO,
      COB_DATE,
      CASE
        WHEN L1_CTGRY IS NOT NULL
        THEN NVL(DIMENSION_KEY,'UNALLOCATED') 
        WHEN  (REF_TBL.REF_KEY IS NULL)
        THEN '#MISSING_REFERENCE_DATA'
        WHEN INCOMPREC_IND = 1
        THEN '#INCOMPLETE_REFERENCE_DATA'
        ELSE NULL
      END AS EXCEPTION_KEY,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DIMENSION_KEY
      END AS DIMENSION_KEY,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY1
      END AS DRILLDOWN_KEY1,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY2
      END AS DRILLDOWN_KEY2,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY3
      END AS DRILLDOWN_KEY3,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY4
      END AS DRILLDOWN_KEY4,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY5
      END AS DRILLDOWN_KEY5
    FROM 
    ( SELECT /*+ PARALLEL (T1,12) FULL(T1) */ ITEM_COUNT AS ITEM_CNT ,
FEED.FEED_SID AS DATSET_METADATA_UID,
SOURCESYSTEM AS FEED_SRC_SYS,
NULL AS SRC_FILE_CD ,
A1.ASET_LVL_0_DESC AS PRODUCT,
NULL AS MATCH_STATUS,
LGL_ENTY_KEY AS DIMENSION_KEY,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        TRUNC(COB_DATE, DECODE(UPPER(NVL('DAY','DAY')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','DAY'))
    ELSE
        TRUNC(COB_DATE, DECODE(UPPER(NVL('WEEK','WEEK')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','WEEK'))
END COB_DATE,
T1.MEASMT_TYP AS BREAK_DOWN1,
T1.METRICS_CATEGORY AS BREAK_DOWN2,
NULL AS BREAK_DOWN3,
NULL AS BREAK_DOWN4,
NULL AS BREAK_DOWN5,
NULL AS DRILLDOWN_KEY1,
NULL AS DRILLDOWN_KEY2,
NULL AS DRILLDOWN_KEY3,
NULL AS DRILLDOWN_KEY4,
NULL AS DRILLDOWN_KEY5,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        UPPER(NVL('DAY','DAY'))
    ELSE
        UPPER(NVL('WEEK','WEEK'))
END COB_DATE_ROLLUP_TO
 FROM (select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120103) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120104) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120105) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120106) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120107) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120108) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120109) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120110) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120111) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120112) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120113) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120114) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120115) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120116) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120117) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120118) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120119) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120120) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120121) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120122) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120123) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120124) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120125) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120126) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120127) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120128) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120129) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120130) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120131) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120201) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121222) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121223) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121224) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121225) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121226) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121227) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121228) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121229) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121230) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121231) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121116) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121117) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121118) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121119) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121120) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121121) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121122) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121123) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121124) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121125) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121126) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121127) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121128) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121129) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121130) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121201) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121202) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121203) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121204) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121205) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121206) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121207) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121208) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121209) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121210) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121211) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121212) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121213) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121214) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121215) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121216) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121217) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121218) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121219) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121220) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121221) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121011) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121012) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121013) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121014) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121015) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121016) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121017) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121018) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121019) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121020) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121021) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121022) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121023) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121024) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121025) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121026) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121027) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121028) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121029) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121030) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121031) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121103) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121104) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121105) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121106) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121107) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121108) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121109) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121110) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121111) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121112) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121113) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121114) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121115) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120905) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120906) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120907) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120908) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120909) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120910) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120911) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120912) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120913) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120914) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120915) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120916) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120917) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120918) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120919) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120920) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120921) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120922) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120923) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120924) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120925) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120926) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120927) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120928) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120929) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120930) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121001) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121002) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121003) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121004) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121005) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121006) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121007) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121008) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121009) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20121010) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120731) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120801) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120802) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120803) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120804) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120805) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120806) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120807) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120808) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120809) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120810) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120811) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120812) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120813) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120814) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120815) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120816) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120817) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120818) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120819) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120820) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120821) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120822) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120823) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120824) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120825) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120826) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120827) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120828) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120829) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120830) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120831) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120901) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120902) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120903) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120904) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120625) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120626) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120627) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120628) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120629) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120630) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120701) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120702) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120703) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120704) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120705) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120706) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120707) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120708) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120709) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120710) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120711) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120712) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120713) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120714) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120715) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120716) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120717) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120718) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120719) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120720) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120721) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120722) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120723) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120724) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120725) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120726) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120727) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120728) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120729) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120730) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120520) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120521) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120522) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120523) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120524) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120525) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120526) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120527) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120528) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120529) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120530) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120531) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120601) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120602) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120603) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120604) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120605) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120606) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120607) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120608) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120609) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120610) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120611) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120612) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120613) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120614) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120615) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120616) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120617) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120618) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120619) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120620) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120621) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120622) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120623) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120624) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120414) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120415) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120416) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120417) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120418) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120419) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120420) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120421) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120422) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120423) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120424) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120425) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120426) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120427) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120428) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120429) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120430) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120501) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120502) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120503) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120504) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120505) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120506) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120507) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120508) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120509) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120510) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120511) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120512) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120513) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120514) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120515) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120516) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120517) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120518) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120519) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120309) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120310) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120311) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120312) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120313) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120314) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120315) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120316) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120317) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120318) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120319) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120320) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120321) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120322) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120323) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120324) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120325) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120326) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120327) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120328) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120329) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120330) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120331) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120401) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120402) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120403) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120404) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120405) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120406) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120407) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120408) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120409) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120410) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120411) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120412) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120413) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120202) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120204) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120205) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120206) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120207) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120208) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120209) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120210) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120203) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120211) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120212) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120213) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120214) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120215) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120216) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120217) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120218) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120219) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120220) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120221) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120222) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120223) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120224) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120225) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120226) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120227) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120228) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120229) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120301) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120302) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120303) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120304) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120305) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120306) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120307) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20120308) )  T1,
 ( select ASET_LVL_KEY ASET_LVL_KEY1, ASET_LVL_0_DESC FROM csmartref.MAN_REF_ASET_LVL_DATA) A1,
(Select FEED_SID,SRC_FILE_CD  from CSMARTREF.SMART_ETL_FEED_MSTR FEED WHERE STRM_SID =6 ) FEED WHERE T1.ASET_CLAS_KEY = A1.ASET_LVL_KEY1 (+)
AND upper('FAILS_' ||
DECODE(T1.SOURCESYSTEM ,'IOWAAU','IOWA_AU',T1.SOURCESYSTEM) ) = upper(FEED.SRC_FILE_CD (+))
AND SOURCESYSTEM NOT IN ( 'OASYSEF','CLU' )
        AND METRICS_CATEGORY    = 'FAIL'
        AND FAIL_INDICATOR      ='Y'
AND COB_DATE  >= TO_DATE(NVL('01-JAN-11','23-FEB-2013'))
AND  COB_DATE  <= TO_DATE(NVL('23-FEB-13','23-FEB-2013')) ) FACT_TBL,
    ( SELECT
            CASE
                WHEN MAN_REF_LGL_ENTY_DATA.LGL_ENTY_ID IS NULL
                THEN 1
                ELSE 0
            END AS INCOMPREC_IND,
            MAN_REF_LGL_ENTY_XREF.LGL_ENTY_KEY REF_KEY
        FROM csmartref.MAN_REF_LGL_ENTY_XREF,
            csmartref.MAN_REF_LGL_ENTY_DATA
        WHERE MAN_REF_LGL_ENTY_DATA.LGL_ENTY_ID(+) =MAN_REF_LGL_ENTY_XREF.LGL_ENTY_ID ) REF_TBL ,
    ( SELECT
            L0_CTGRY,
            L1_CTGRY,
            STAT_KEY_VAL
        FROM DQSMART.MAN_REF_STATIC_KEYS_TEMP) STATIC_KEYS_TBL
     WHERE FACT_TBL.DIMENSION_KEY =REF_TBL.REF_KEY(+)
     AND NVL(FACT_TBL.DIMENSION_KEY,'UNALLOCATED') =STATIC_KEYS_TBL.STAT_KEY_VAL(+)
 GROUP BY
      DATSET_METADATA_UID,
      FEED_SRC_SYS,
      SRC_FILE_CD,
      PRODUCT,
      MATCH_STATUS,
      BREAK_DOWN1,
      BREAK_DOWN2,
      BREAK_DOWN3,
      BREAK_DOWN4,
      BREAK_DOWN5,
      COB_DATE_ROLLUP_TO,
      CASE
        WHEN L1_CTGRY IS NOT NULL
        THEN NVL(DIMENSION_KEY,'UNALLOCATED') 
        WHEN  (REF_TBL.REF_KEY IS NULL)
        THEN '#MISSING_REFERENCE_DATA'
        WHEN INCOMPREC_IND = 1
        THEN '#INCOMPLETE_REFERENCE_DATA'
        ELSE NULL
      END ,
      COB_DATE,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DIMENSION_KEY
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY1
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY2
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY3
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY4
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY5
      END 
  ) );
]]>
      </sql_template>
    </table_utils>
  </exec_query_spool>
</worker1>

<worker1 name="FAILS.SPOOL.2013">
  <exec_query_spool>
    <table_utils 	method="%QUERY_SPOOL_METHOD%" >
     	<param name="IF_COMPRESSED_SPOOL" value="0"></param>
      <sql_template>
        <![CDATA[ 
SELECT --+parallel1
 ROUND(DQCHK_VAL,4) DQCHK_VAL,ROUND(DQCHK_TOT,4) DQCHK_TOT,DRLDWN_CPK1,DRLDWN_CPK2,DRLDWN_CPK3,DRLDWN_CPK4,DRLDWN_CPK5,DRLDWN_CPK6,DRLDWN_CPK7,DRLDWN_CPK8,DRLDWN_CPK9,DRLDWN_CPK10,DQCHK_GEN_VAL1 ,DQCHK_GEN_VAL2 ,DQCHK_GEN_VAL3 ,DQCHK_GEN_VAL4 ,DQCHK_GEN_VAL5 ,DQCHK_GEN_VAL6 ,DQCHK_GEN_VAL7 ,DQCHK_GEN_VAL8 ,DQCHK_GEN_VAL9 ,NULL DQCHK_GEN_VAL10,DQCHK_DATASET_SID , NULL FK_CMT_UNIQ_KEY  FROM ( SELECT
  SUM(ITEMS_AFFECTED) OVER (PARTITION BY FEED_SRC_SYS,SRC_FILE_CD,PRODUCT,MATCH_STATUS,BREAK_DOWN1,BREAK_DOWN2,BREAK_DOWN3,BREAK_DOWN4,BREAK_DOWN5) DQCHK_VAL,
  SUM(TOTAL_ITEMS) OVER (PARTITION BY FEED_SRC_SYS,SRC_FILE_CD,PRODUCT,MATCH_STATUS,BREAK_DOWN1,BREAK_DOWN2,BREAK_DOWN3,BREAK_DOWN4,BREAK_DOWN5) DQCHK_TOT,
  DATSET_METADATA_UID DQCHK_DATASET_SID,
  FEED_SRC_SYS   AS DQCHK_GEN_VAL1,
  SRC_FILE_CD    AS DQCHK_GEN_VAL2,
  PRODUCT AS DQCHK_GEN_VAL3,
  MATCH_STATUS AS DQCHK_GEN_VAL4,
  BREAK_DOWN1 AS DQCHK_GEN_VAL5,
  BREAK_DOWN2 AS DQCHK_GEN_VAL6,
  BREAK_DOWN3 AS DQCHK_GEN_VAL7,
  BREAK_DOWN4 AS DQCHK_GEN_VAL8,
  BREAK_DOWN5 AS DQCHK_GEN_VAL9,
  TOTAL_ITEMS AS DRLDWN_CPK1,
  COB_DATE_ROLLUP_TO   AS DRLDWN_CPK2,
  EXCEPTION_KEY AS DRLDWN_CPK3,
  DIMENSION_KEY AS DRLDWN_CPK4,
  COB_DATE AS DRLDWN_CPK5,
  DRILLDOWN_KEY1 AS DRLDWN_CPK6,
  DRILLDOWN_KEY2 AS DRLDWN_CPK7,
  DRILLDOWN_KEY3 AS DRLDWN_CPK8,
  DRILLDOWN_KEY4 AS DRLDWN_CPK9,
  DRILLDOWN_KEY5 AS DRLDWN_CPK10
FROM
  (
    SELECT
      SUM(ITEM_CNT) TOTAL_ITEMS,
      SUM(
        CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
          THEN ITEM_CNT
          ELSE 0
        END) AS ITEMS_AFFECTED,
      DATSET_METADATA_UID,
      FEED_SRC_SYS,
      SRC_FILE_CD,
      PRODUCT,
      MATCH_STATUS,
      BREAK_DOWN1,
      BREAK_DOWN2,
      BREAK_DOWN3,
      BREAK_DOWN4,
      BREAK_DOWN5,
      COB_DATE_ROLLUP_TO,
      COB_DATE,
      CASE
        WHEN L1_CTGRY IS NOT NULL
        THEN NVL(DIMENSION_KEY,'UNALLOCATED') 
        WHEN  (REF_TBL.REF_KEY IS NULL)
        THEN '#MISSING_REFERENCE_DATA'
        WHEN INCOMPREC_IND = 1
        THEN '#INCOMPLETE_REFERENCE_DATA'
        ELSE NULL
      END AS EXCEPTION_KEY,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DIMENSION_KEY
      END AS DIMENSION_KEY,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY1
      END AS DRILLDOWN_KEY1,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY2
      END AS DRILLDOWN_KEY2,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY3
      END AS DRILLDOWN_KEY3,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY4
      END AS DRILLDOWN_KEY4,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY5
      END AS DRILLDOWN_KEY5
    FROM 
    ( SELECT /*+ PARALLEL (T1,12) FULL(T1) */ ITEM_COUNT AS ITEM_CNT ,
FEED.FEED_SID AS DATSET_METADATA_UID,
SOURCESYSTEM AS FEED_SRC_SYS,
NULL AS SRC_FILE_CD ,
A1.ASET_LVL_0_DESC AS PRODUCT,
NULL AS MATCH_STATUS,
LGL_ENTY_KEY AS DIMENSION_KEY,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        TRUNC(COB_DATE, DECODE(UPPER(NVL('DAY','DAY')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','DAY'))
    ELSE
        TRUNC(COB_DATE, DECODE(UPPER(NVL('WEEK','WEEK')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','WEEK'))
END COB_DATE,
T1.MEASMT_TYP AS BREAK_DOWN1,
T1.METRICS_CATEGORY AS BREAK_DOWN2,
NULL AS BREAK_DOWN3,
NULL AS BREAK_DOWN4,
NULL AS BREAK_DOWN5,
NULL AS DRILLDOWN_KEY1,
NULL AS DRILLDOWN_KEY2,
NULL AS DRILLDOWN_KEY3,
NULL AS DRILLDOWN_KEY4,
NULL AS DRILLDOWN_KEY5,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        UPPER(NVL('DAY','DAY'))
    ELSE
        UPPER(NVL('WEEK','WEEK'))
END COB_DATE_ROLLUP_TO
 FROM (select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130103) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130104) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130105) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130106) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130107) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130108) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130109) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130110) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130111) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130112) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130113) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130114) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130115) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130116) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130117) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130118) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130119) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130120) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130121) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130122) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130123) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130124) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130125) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130126) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130127) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130128) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130129) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130130) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130131) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130201) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130202) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130203) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130204) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130205) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130206) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130207) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130208) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130209) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130210) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130211) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130212) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130213) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130214) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130215) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130216) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130217) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130218) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130219) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130220) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130221) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130222) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130223) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130224) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130225) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130226) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130227) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20130228)  )  T1,
 ( select ASET_LVL_KEY ASET_LVL_KEY1, ASET_LVL_0_DESC FROM csmartref.MAN_REF_ASET_LVL_DATA) A1,
(Select FEED_SID,SRC_FILE_CD  from CSMARTREF.SMART_ETL_FEED_MSTR FEED WHERE STRM_SID =6 ) FEED WHERE T1.ASET_CLAS_KEY = A1.ASET_LVL_KEY1 (+)
AND upper('FAILS_' ||
DECODE(T1.SOURCESYSTEM ,'IOWAAU','IOWA_AU',T1.SOURCESYSTEM) ) = upper(FEED.SRC_FILE_CD (+))
AND SOURCESYSTEM NOT IN ( 'OASYSEF','CLU' )
        AND METRICS_CATEGORY    = 'FAIL'
        AND FAIL_INDICATOR      ='Y'
AND COB_DATE  >= TO_DATE(NVL('01-JAN-11','23-FEB-2013'))
AND  COB_DATE  <= TO_DATE(NVL('23-FEB-13','23-FEB-2013')) ) FACT_TBL,
    ( SELECT
            CASE
                WHEN MAN_REF_LGL_ENTY_DATA.LGL_ENTY_ID IS NULL
                THEN 1
                ELSE 0
            END AS INCOMPREC_IND,
            MAN_REF_LGL_ENTY_XREF.LGL_ENTY_KEY REF_KEY
        FROM csmartref.MAN_REF_LGL_ENTY_XREF,
            csmartref.MAN_REF_LGL_ENTY_DATA
        WHERE MAN_REF_LGL_ENTY_DATA.LGL_ENTY_ID(+) =MAN_REF_LGL_ENTY_XREF.LGL_ENTY_ID ) REF_TBL ,
    ( SELECT
            L0_CTGRY,
            L1_CTGRY,
            STAT_KEY_VAL
        FROM DQSMART.MAN_REF_STATIC_KEYS_TEMP) STATIC_KEYS_TBL
     WHERE FACT_TBL.DIMENSION_KEY =REF_TBL.REF_KEY(+)
     AND NVL(FACT_TBL.DIMENSION_KEY,'UNALLOCATED') =STATIC_KEYS_TBL.STAT_KEY_VAL(+)
 GROUP BY
      DATSET_METADATA_UID,
      FEED_SRC_SYS,
      SRC_FILE_CD,
      PRODUCT,
      MATCH_STATUS,
      BREAK_DOWN1,
      BREAK_DOWN2,
      BREAK_DOWN3,
      BREAK_DOWN4,
      BREAK_DOWN5,
      COB_DATE_ROLLUP_TO,
      CASE
        WHEN L1_CTGRY IS NOT NULL
        THEN NVL(DIMENSION_KEY,'UNALLOCATED') 
        WHEN  (REF_TBL.REF_KEY IS NULL)
        THEN '#MISSING_REFERENCE_DATA'
        WHEN INCOMPREC_IND = 1
        THEN '#INCOMPLETE_REFERENCE_DATA'
        ELSE NULL
      END ,
      COB_DATE,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DIMENSION_KEY
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY1
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY2
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY3
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY4
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY5
      END 
  ) );
]]>
      </sql_template>
    </table_utils>
  </exec_query_spool>
</worker1>



<worker1 name="FAILS.SPOOL_05">
  <exec_query_spool>
    <table_utils 	method="%QUERY_SPOOL_METHOD%" >
     	<param name="IF_COMPRESSED_SPOOL" value="0"></param>
      <sql_template>
        <![CDATA[ 
SELECT --+parallel1
 ROUND(DQCHK_VAL,4) DQCHK_VAL,ROUND(DQCHK_TOT,4) DQCHK_TOT,DRLDWN_CPK1,DRLDWN_CPK2,DRLDWN_CPK3,DRLDWN_CPK4,DRLDWN_CPK5,DRLDWN_CPK6,DRLDWN_CPK7,DRLDWN_CPK8,DRLDWN_CPK9,DRLDWN_CPK10,DQCHK_GEN_VAL1 ,DQCHK_GEN_VAL2 ,DQCHK_GEN_VAL3 ,DQCHK_GEN_VAL4 ,DQCHK_GEN_VAL5 ,DQCHK_GEN_VAL6 ,DQCHK_GEN_VAL7 ,DQCHK_GEN_VAL8 ,DQCHK_GEN_VAL9 ,NULL DQCHK_GEN_VAL10,DQCHK_DATASET_SID , NULL FK_CMT_UNIQ_KEY  FROM ( SELECT
  SUM(ITEMS_AFFECTED) OVER (PARTITION BY FEED_SRC_SYS,SRC_FILE_CD,PRODUCT,MATCH_STATUS,BREAK_DOWN1,BREAK_DOWN2,BREAK_DOWN3,BREAK_DOWN4,BREAK_DOWN5) DQCHK_VAL,
  SUM(TOTAL_ITEMS) OVER (PARTITION BY FEED_SRC_SYS,SRC_FILE_CD,PRODUCT,MATCH_STATUS,BREAK_DOWN1,BREAK_DOWN2,BREAK_DOWN3,BREAK_DOWN4,BREAK_DOWN5) DQCHK_TOT,
  DATSET_METADATA_UID DQCHK_DATASET_SID,
  FEED_SRC_SYS   AS DQCHK_GEN_VAL1,
  SRC_FILE_CD    AS DQCHK_GEN_VAL2,
  PRODUCT AS DQCHK_GEN_VAL3,
  MATCH_STATUS AS DQCHK_GEN_VAL4,
  BREAK_DOWN1 AS DQCHK_GEN_VAL5,
  BREAK_DOWN2 AS DQCHK_GEN_VAL6,
  BREAK_DOWN3 AS DQCHK_GEN_VAL7,
  BREAK_DOWN4 AS DQCHK_GEN_VAL8,
  BREAK_DOWN5 AS DQCHK_GEN_VAL9,
  TOTAL_ITEMS AS DRLDWN_CPK1,
  COB_DATE_ROLLUP_TO   AS DRLDWN_CPK2,
  EXCEPTION_KEY AS DRLDWN_CPK3,
  DIMENSION_KEY AS DRLDWN_CPK4,
  COB_DATE AS DRLDWN_CPK5,
  DRILLDOWN_KEY1 AS DRLDWN_CPK6,
  DRILLDOWN_KEY2 AS DRLDWN_CPK7,
  DRILLDOWN_KEY3 AS DRLDWN_CPK8,
  DRILLDOWN_KEY4 AS DRLDWN_CPK9,
  DRILLDOWN_KEY5 AS DRLDWN_CPK10
FROM
  (
    SELECT
      SUM(ITEM_CNT) TOTAL_ITEMS,
      SUM(
        CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
          THEN ITEM_CNT
          ELSE 0
        END) AS ITEMS_AFFECTED,
      DATSET_METADATA_UID,
      FEED_SRC_SYS,
      SRC_FILE_CD,
      PRODUCT,
      MATCH_STATUS,
      BREAK_DOWN1,
      BREAK_DOWN2,
      BREAK_DOWN3,
      BREAK_DOWN4,
      BREAK_DOWN5,
      COB_DATE_ROLLUP_TO,
      COB_DATE,
      CASE
        WHEN L1_CTGRY IS NOT NULL
        THEN NVL(DIMENSION_KEY,'UNALLOCATED') 
        WHEN  (REF_TBL.REF_KEY IS NULL)
        THEN '#MISSING_REFERENCE_DATA'
        WHEN INCOMPREC_IND = 1
        THEN '#INCOMPLETE_REFERENCE_DATA'
        ELSE NULL
      END AS EXCEPTION_KEY,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DIMENSION_KEY
      END AS DIMENSION_KEY,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY1
      END AS DRILLDOWN_KEY1,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY2
      END AS DRILLDOWN_KEY2,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY3
      END AS DRILLDOWN_KEY3,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY4
      END AS DRILLDOWN_KEY4,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY5
      END AS DRILLDOWN_KEY5
    FROM 
    ( SELECT /*+ PARALLEL (T1,12) FULL(T1) */ ITEM_COUNT AS ITEM_CNT ,
FEED.FEED_SID AS DATSET_METADATA_UID,
SOURCESYSTEM AS FEED_SRC_SYS,
NULL AS SRC_FILE_CD ,
A1.ASET_LVL_0_DESC AS PRODUCT,
NULL AS MATCH_STATUS,
LGL_ENTY_KEY AS DIMENSION_KEY,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        TRUNC(COB_DATE, DECODE(UPPER(NVL('DAY','DAY')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','DAY'))
    ELSE
        TRUNC(COB_DATE, DECODE(UPPER(NVL('WEEK','WEEK')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','WEEK'))
END COB_DATE,
T1.MEASMT_TYP AS BREAK_DOWN1,
T1.METRICS_CATEGORY AS BREAK_DOWN2,
NULL AS BREAK_DOWN3,
NULL AS BREAK_DOWN4,
NULL AS BREAK_DOWN5,
NULL AS DRILLDOWN_KEY1,
NULL AS DRILLDOWN_KEY2,
NULL AS DRILLDOWN_KEY3,
NULL AS DRILLDOWN_KEY4,
NULL AS DRILLDOWN_KEY5,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        UPPER(NVL('DAY','DAY'))
    ELSE
        UPPER(NVL('WEEK','WEEK'))
END COB_DATE_ROLLUP_TO
 FROM (select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110103)  )  T1,
 ( select ASET_LVL_KEY ASET_LVL_KEY1, ASET_LVL_0_DESC FROM csmartref.MAN_REF_ASET_LVL_DATA) A1,
(Select FEED_SID,SRC_FILE_CD  from CSMARTREF.SMART_ETL_FEED_MSTR FEED WHERE STRM_SID =6 ) FEED WHERE T1.ASET_CLAS_KEY = A1.ASET_LVL_KEY1 (+)
AND upper('FAILS_' ||
DECODE(T1.SOURCESYSTEM ,'IOWAAU','IOWA_AU',T1.SOURCESYSTEM) ) = upper(FEED.SRC_FILE_CD (+))
AND SOURCESYSTEM NOT IN ( 'OASYSEF','CLU' )
        AND METRICS_CATEGORY    = 'FAIL'
        AND FAIL_INDICATOR      ='Y'
AND COB_DATE  >= TO_DATE(NVL('01-JAN-11','23-FEB-2013'))
AND  COB_DATE  <= TO_DATE(NVL('23-FEB-13','23-FEB-2013')) ) FACT_TBL,
    ( SELECT
            CASE
                WHEN MAN_REF_LGL_ENTY_DATA.LGL_ENTY_ID IS NULL
                THEN 1
                ELSE 0
            END AS INCOMPREC_IND,
            MAN_REF_LGL_ENTY_XREF.LGL_ENTY_KEY REF_KEY
        FROM csmartref.MAN_REF_LGL_ENTY_XREF,
            csmartref.MAN_REF_LGL_ENTY_DATA
        WHERE MAN_REF_LGL_ENTY_DATA.LGL_ENTY_ID(+) =MAN_REF_LGL_ENTY_XREF.LGL_ENTY_ID ) REF_TBL ,
    ( SELECT
            L0_CTGRY,
            L1_CTGRY,
            STAT_KEY_VAL
        FROM DQSMART.MAN_REF_STATIC_KEYS_TEMP) STATIC_KEYS_TBL
     WHERE FACT_TBL.DIMENSION_KEY =REF_TBL.REF_KEY(+)
     AND NVL(FACT_TBL.DIMENSION_KEY,'UNALLOCATED') =STATIC_KEYS_TBL.STAT_KEY_VAL(+)
 GROUP BY
      DATSET_METADATA_UID,
      FEED_SRC_SYS,
      SRC_FILE_CD,
      PRODUCT,
      MATCH_STATUS,
      BREAK_DOWN1,
      BREAK_DOWN2,
      BREAK_DOWN3,
      BREAK_DOWN4,
      BREAK_DOWN5,
      COB_DATE_ROLLUP_TO,
      CASE
        WHEN L1_CTGRY IS NOT NULL
        THEN NVL(DIMENSION_KEY,'UNALLOCATED') 
        WHEN  (REF_TBL.REF_KEY IS NULL)
        THEN '#MISSING_REFERENCE_DATA'
        WHEN INCOMPREC_IND = 1
        THEN '#INCOMPLETE_REFERENCE_DATA'
        ELSE NULL
      END ,
      COB_DATE,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DIMENSION_KEY
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY1
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY2
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY3
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY4
      END ,
      CASE
         WHEN L1_CTGRY IS NOT NULL 
          OR (REF_TBL.REF_KEY IS NULL)  
          OR INCOMPREC_IND = 1
         THEN DRILLDOWN_KEY5
      END 
  ) );
]]>
      </sql_template>
    </table_utils>
  </exec_query_spool>
</worker1>


<worker1 name="FAILS.SPOOL_05">
  <exec_query_spool>
    <table_utils 	method="%QUERY_SPOOL_METHOD%" >
     	<param name="IF_COMPRESSED_SPOOL" value="0"></param>
      <sql_template>
        <![CDATA[ 
SELECT /*+ PARALLEL (T1,12) FULL(T1) */ ITEM_COUNT AS ITEM_CNT ,
FEED.FEED_SID AS DATSET_METADATA_UID,
SOURCESYSTEM AS FEED_SRC_SYS,
NULL AS SRC_FILE_CD ,
A1.ASET_LVL_0_DESC AS PRODUCT,
NULL AS MATCH_STATUS,
LGL_ENTY_KEY AS DIMENSION_KEY,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        TRUNC(COB_DATE, DECODE(UPPER(NVL('DAY','DAY')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','DAY'))
    ELSE
        TRUNC(COB_DATE, DECODE(UPPER(NVL('WEEK','WEEK')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','WEEK'))
END COB_DATE,
T1.MEASMT_TYP AS BREAK_DOWN1,
T1.METRICS_CATEGORY AS BREAK_DOWN2,
NULL AS BREAK_DOWN3,
NULL AS BREAK_DOWN4,
NULL AS BREAK_DOWN5,
NULL AS DRILLDOWN_KEY1,
NULL AS DRILLDOWN_KEY2,
NULL AS DRILLDOWN_KEY3,
NULL AS DRILLDOWN_KEY4,
NULL AS DRILLDOWN_KEY5,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        UPPER(NVL('DAY','DAY'))
    ELSE
        UPPER(NVL('WEEK','WEEK'))
END COB_DATE_ROLLUP_TO
 FROM (select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110103) )  T1,
 ( select ASET_LVL_KEY ASET_LVL_KEY1, ASET_LVL_0_DESC FROM csmartref.MAN_REF_ASET_LVL_DATA) A1,
(Select FEED_SID,SRC_FILE_CD  from CSMARTREF.SMART_ETL_FEED_MSTR FEED WHERE STRM_SID =6 ) FEED WHERE T1.ASET_CLAS_KEY = A1.ASET_LVL_KEY1 (+)
AND upper('FAILS_' ||
DECODE(T1.SOURCESYSTEM ,'IOWAAU','IOWA_AU',T1.SOURCESYSTEM) ) = upper(FEED.SRC_FILE_CD (+))
AND SOURCESYSTEM NOT IN ( 'OASYSEF','CLU' )
        AND METRICS_CATEGORY    = 'FAIL'
        AND FAIL_INDICATOR      ='Y'
AND COB_DATE  >= TO_DATE(NVL('01-JAN-11','23-FEB-2013'))
AND  COB_DATE  <= TO_DATE(NVL('23-FEB-13','23-FEB-2013'));
]]>
      </sql_template>
    </table_utils>
  </exec_query_spool>
</worker1>

<worker1 name="FAILS.SPOOL_02">
  <exec_query_spool>
    <table_utils 	method="%QUERY_SPOOL_METHOD%" >
     	<param name="IF_COMPRESSED_SPOOL" value="0"></param>
      <sql_template>
        <![CDATA[ 
SELECT /*+ PARALLEL (T1,12) FULL(T1) */ ITEM_COUNT AS ITEM_CNT ,
FEED.FEED_SID AS DATSET_METADATA_UID,
SOURCESYSTEM AS FEED_SRC_SYS,
NULL AS SRC_FILE_CD ,
A1.ASET_LVL_0_DESC AS PRODUCT,
NULL AS MATCH_STATUS,
LGL_ENTY_KEY AS DIMENSION_KEY,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        TRUNC(COB_DATE, DECODE(UPPER(NVL('DAY','DAY')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','DAY'))
    ELSE
        TRUNC(COB_DATE, DECODE(UPPER(NVL('WEEK','WEEK')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','WEEK'))
END COB_DATE,
T1.MEASMT_TYP AS BREAK_DOWN1,
T1.METRICS_CATEGORY AS BREAK_DOWN2,
NULL AS BREAK_DOWN3,
NULL AS BREAK_DOWN4,
NULL AS BREAK_DOWN5,
NULL AS DRILLDOWN_KEY1,
NULL AS DRILLDOWN_KEY2,
NULL AS DRILLDOWN_KEY3,
NULL AS DRILLDOWN_KEY4,
NULL AS DRILLDOWN_KEY5,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        UPPER(NVL('DAY','DAY'))
    ELSE
        UPPER(NVL('WEEK','WEEK'))
END COB_DATE_ROLLUP_TO
 FROM (select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110103) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110104) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110105) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110106) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110107) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110108) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110109) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110110) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110111) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110112) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110113) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110114) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110115) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110116) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110117) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110118) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110119) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110120) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110121) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110122) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110123) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110124) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110125) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110126) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110127) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110128) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110129) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110130) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110131) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110201) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110202) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110203) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110204) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110205) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110206) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110207) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110208) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110209) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110210) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110211) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110212) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110213) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110214) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110215) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110216) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110217) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110218) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110219) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110220) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110221) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110222) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110223) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110224) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110225) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110226) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110227) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110228) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110301) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110302) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110303) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110304) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110305) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110306) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110307) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110308) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110309) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110310) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110311) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110312) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110313) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110314) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110315) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110316) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110317) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110318) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110319) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110320) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110321) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110322) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110323) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110324) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110325) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110326) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110327) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110328) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110329) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110330) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110331) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110401) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110402) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110403) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110404) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110405) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110406) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110407) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110408) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110409) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110410) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110411) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110412) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110413) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110414) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110415) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110416) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110417) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110418) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110419) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110420) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110421) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110422) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110423) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110424) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110425) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110426) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110427) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110428) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110429) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110430) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110501) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110502) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110503) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110504) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110505) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110506) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110507) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110508) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110509) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110510) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110511) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110512) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110513) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110514) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110515) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110516) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110517) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110518) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110519) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110520) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110521) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110522) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110523) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110524) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110525) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110526) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110527) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110528) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110529) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110530) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110531) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110601) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110602) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110603) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110604) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110605) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110606) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110607) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110608) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110609) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110610) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110611) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110612) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110613) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110614) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110615) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110616) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110617) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110618) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110619) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110620) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110621) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110622) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110623) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110624) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110625) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110626) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110627) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110628) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110629) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110630) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110701) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110702) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110703) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110704) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110705) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110706) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110707) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110708) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110709) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110710) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110711) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110712) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110713) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110714) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110715) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110716) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110717) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110718) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110719) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110720) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110721) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110722) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110723) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110724) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110725) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110726) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110727) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110728) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110729) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110730) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110731) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110801) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110802) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110803) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110804) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110805) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110806) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110807) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110808) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110809) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110810) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110811) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110812) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110813) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110814) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110815) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110816) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110817) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110818) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110819) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110820) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110821) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110822) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110823) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110824) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110825) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110826) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110827) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110828) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110829) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110830) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110831) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110901) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110902) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110903) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110904) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110905) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110906) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110907) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110908) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110909) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110910) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110911) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110912) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110913) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110914) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110915) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110916) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110917) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110918) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110919) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110920) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110921) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110922) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110923) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110924) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110925) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110926) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110927) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110928) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110929) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110930) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111001) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111002) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111003) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111004) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111005) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111006) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111007) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111008) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111009) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111010) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111011) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111012) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111013) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111014) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111015) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111016) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111017) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111018) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111019) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111020) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111021) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111022) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111023) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111024) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111025) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111026) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111027) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111028) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111029) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111030) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111031) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111103) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111104) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111105) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111106) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111107) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111108) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111109) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111110) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111111) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111112) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111113) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111114) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111115) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111116) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111117) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111118) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111119) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111120) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111121) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111122) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111123) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111124) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111125) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111126) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111127) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111128) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111129) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111130) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111201) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111202) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111203) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111204) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111205) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111206) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111207) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111208) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111209) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111210) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111211) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111212) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111213) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111214) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111215) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111216) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111217) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111218) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111219) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111220) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111221) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111222) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111223) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111224) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111225) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111226) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111227) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111228) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111229) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111230) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20111231)  )  T1,
 ( select ASET_LVL_KEY ASET_LVL_KEY1, ASET_LVL_0_DESC FROM csmartref.MAN_REF_ASET_LVL_DATA) A1,
(Select FEED_SID,SRC_FILE_CD  from CSMARTREF.SMART_ETL_FEED_MSTR FEED WHERE STRM_SID =6 ) FEED WHERE T1.ASET_CLAS_KEY = A1.ASET_LVL_KEY1 (+)
AND upper('FAILS_' ||
DECODE(T1.SOURCESYSTEM ,'IOWAAU','IOWA_AU',T1.SOURCESYSTEM) ) = upper(FEED.SRC_FILE_CD (+))
AND SOURCESYSTEM NOT IN ( 'OASYSEF','CLU' )
        AND METRICS_CATEGORY    = 'FAIL'
        AND FAIL_INDICATOR      ='Y'
AND COB_DATE  >= TO_DATE(NVL('01-JAN-11','23-FEB-2013'))
AND  COB_DATE  <= TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  ;
]]>
      </sql_template>
    </table_utils>
  </exec_query_spool>
</worker1>


<worker1 name="FAILS.SPOOL_01">
  <exec_query_spool>
    <table_utils 	method="%QUERY_SPOOL_METHOD%" >
     	<param name="IF_COMPRESSED_SPOOL" value="0"></param>
      <sql_template>
        <![CDATA[ 
SELECT /*+ PARALLEL (T1,12) FULL(T1) */ ITEM_COUNT AS ITEM_CNT ,
FEED.FEED_SID AS DATSET_METADATA_UID,
SOURCESYSTEM AS FEED_SRC_SYS,
NULL AS SRC_FILE_CD ,
A1.ASET_LVL_0_DESC AS PRODUCT,
NULL AS MATCH_STATUS,
LGL_ENTY_KEY AS DIMENSION_KEY,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        TRUNC(COB_DATE, DECODE(UPPER(NVL('DAY','DAY')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','DAY'))
    ELSE
        TRUNC(COB_DATE, DECODE(UPPER(NVL('WEEK','WEEK')),'DAY','DD','WEEK','DAY','MONTH','MM','QUARTER','Q','YEAR','YY','WEEK'))
END COB_DATE,
T1.MEASMT_TYP AS BREAK_DOWN1,
T1.METRICS_CATEGORY AS BREAK_DOWN2,
NULL AS BREAK_DOWN3,
NULL AS BREAK_DOWN4,
NULL AS BREAK_DOWN5,
NULL AS DRILLDOWN_KEY1,
NULL AS DRILLDOWN_KEY2,
NULL AS DRILLDOWN_KEY3,
NULL AS DRILLDOWN_KEY4,
NULL AS DRILLDOWN_KEY5,
CASE
    WHEN COB_DATE  > TO_DATE(NVL('23-FEB-13','23-FEB-2013'))  - TO_NUMBER(NVL('90',90)) THEN
        UPPER(NVL('DAY','DAY'))
    ELSE
        UPPER(NVL('WEEK','WEEK'))
END COB_DATE_ROLLUP_TO
 FROM (select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110101) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110102) UNION ALL
select COB_DATE,FAIL_INDICATOR,SOURCESYSTEM,ASET_CLAS_KEY,LGL_ENTY_KEY,ITEM_COUNT,MEASMT_TYP,METRICS_CATEGORY from csmartbser.FAILS_REPORTS_HISTORY  partition(P20110103) )  T1,
 ( select ASET_LVL_KEY ASET_LVL_KEY1, ASET_LVL_0_DESC FROM csmartref.MAN_REF_ASET_LVL_DATA) A1,
(Select FEED_SID,SRC_FILE_CD  from CSMARTREF.SMART_ETL_FEED_MSTR FEED WHERE STRM_SID =6 ) FEED WHERE T1.ASET_CLAS_KEY = A1.ASET_LVL_KEY1 (+)
AND upper('FAILS_' ||
DECODE(T1.SOURCESYSTEM ,'IOWAAU','IOWA_AU',T1.SOURCESYSTEM) ) = upper(FEED.SRC_FILE_CD (+))
AND SOURCESYSTEM NOT IN ( 'OASYSEF','CLU' )
        AND METRICS_CATEGORY    = 'FAIL'
        AND FAIL_INDICATOR      ='Y'
AND COB_DATE  >= TO_DATE(NVL('01-JAN-11','23-FEB-2013'))
AND  COB_DATE  <= TO_DATE(NVL('23-FEB-13','23-FEB-2013'));
]]>
      </sql_template>
    </table_utils>
  </exec_query_spool>
</worker1>



</etldataflow>
