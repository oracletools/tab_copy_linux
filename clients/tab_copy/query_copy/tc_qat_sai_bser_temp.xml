<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright 2011 . All rights reserved.
     Author: AlexBuzunov@gmail.com (Alex Buzunov)
     Python Implementation of ETL pipeline
-->
<etldataflow name="Q_COPY2_TEST">
<globals> 
 
	<!-- PIPELINE execution type
		 SYNC - synchronous, ANYNC - asynchronous 
	-->
	  <param name="FLOW_TYPE" value="ASYNC"></param>	

	  <param name="FIELD_TERMINATOR" value="`^|"></param>
	  <param name="LINE_TERMINATOR" value="~"></param>
	  
  
	  <param name="FROM_DB" value="%AD_SMARTP2%"></param>
	  <param name="FROM_SCHEMA" value="CSMARTBSER"></param>
	  
	  <param name="TO_DB" value="%CSMARTBSER_SMARTQ1%"></param>
	  <param name="TO_SCHEMA" value="CSMARTBSER"></param>	  
	  
	   <!--will spool ALL records if LAME_DUCK=0-->
	  <param name="LAME_DUCK" value='0'></param>
	  <param name="ARRAYSIZE" value="5000"></param>
	  <param name="COPYCOMMIT" value="4"></param>
	  <!--sqlp attribute-->

	  <param name="IF_TRUNCATE" value="0"></param>
	  
	  <param name="IF_SHOW_SERVEROUTPUT" value="1"></param>
	 
</globals>


<worker name="Q1">
  <exec_query_copy>
    <table_utils        method="%QUERY_COPY_METHOD%" >
         <param name="TO_TABLE" value="fails_reports_history_redsn"></param>
	<param name="IF_CREATE_TARGET_TABLE" value="0"></param>
      <sql_template>
        <![CDATA[select GL_ACCOUNT_NUMBER,
COUNTERPARTY_ID,
COUNTERPARTY_NAME,
COUNTERPARTY_PARENT_ID,
TRADE_DATE,
COB_DATE,
SETTLEMENT_DATE_CONTRACTUAL,
BUY_SELL,
REC_DEL,
AMOUNT_REMAINING_SETT_CCY,
SETTLEMENT_CURRENCY,
QUANTITY_REMAINING,
PRICE,
TRANSACTION_TYPE,
SETTLEMENT_LOCATION,
FAIL_REASON_CODE,
FAIL_REASON_DESCRIPTION,
COMMENTARY,
FIRM_ACCOUNT,
OWNERSHIP_CODE,
LEGAL_ENTITY_ID,
LEGAL_ENTITY_NAME,
CUSIP_CODE,
ISIN_CODE,
SEDOL_CODE,
PRODUCT_1_ID,
PRODUCT_1_NAME,
INTERNAL_PRODUCT_DESCRIPTION,
OPS_SETTLEMENT_TRADE_REF,
SOURCESYSTEM,
SYSTEM_ID,
ASSOCIATED_FILE,
FXRATE_KEY,
AGE,
COUNTERPARTY_MNEMONIC,
COUNTERPARTY_PARENT_NAME,
SECURITY_MATURITY_DATE,
AMT_CONTRACTUAL_SETT,
AMT_CONTRACTUAL_USD,
QUANTITY_CONTRACTUAL,
EXCHANGE,
MARKET_OF_SETTLEMENT_CODE,
SALESPERSON_ID,
DESK_NAME,
STRATEGY_NAME,
CUSTOMER_SERVICE_LOCATION,
COMMON_CODE,
PRODUCT_2_ID,
INTERNAL_PRODUCT_ID,
SDI_INSTRUCTIONS,
COMMENTARY_DATE,
COMMENTARY_USER_ID,
CONFIRMATION_STATUS,
MATCH_STATUS,
STATUS,
DK_INDICATOR,
PARTIAL_INDICATOR,
LINKED_INDICATOR,
FO_TRADE_REF,
AGE_BAND,
COUNTERPARTY_CLASSIFICATION,
AMOUNT_REMAINING_USD,
CURRENT_MARKET_VALUE,
CURRENT_MARKET_PRICE,
YIELD,
INTEREST,
FAIL_COST_CURRENCY,
TRADER_ID,
INVESTMENT_MANAGER_ID,
SETTLEMENT_BROKER_DTC_NUM,
BLOTTER_CODE,
POOL_ID,
TICKER_SYMBOL,
EXTERNAL_TRADE_REF,
BRANCH,
FAIL_INDICATOR,
FAIL_EVENT_TYPE,
SETT_LOC_INT_BANK_CODE,
FAIL_COST_DAILY_SETT_CCY,
SALESPERSON_NAME,
TRADER_NAME,
LONG_SHORT_INDICATOR,
TRADING_BROKER,
TRADING_BROKER_DTC_NUM,
PRODUCT_3_ID,
AS_OF_DATE,
OVER_30_FLAG,
OVER_180_FLAG,
OPERATIONS_TRADE_REF,
ADDITIONAL_TRADE_REF,
CONFIRMATION_STATUS_DESC,
MULTI_SETTL_SYSTEM_DUPLICATE,
STOCK_RECORD_TRADE_REF,
SETTLEMENT_BROKER,
METRICS_CATEGORY,
SAFEKEEP_INDICATOR,
COMMENTARY_USER_NAME,
CUSTOMER_ACCOUNT_NUMBER,
SECURITY_MATURITY_DATE_DT,
AMOUNT_REMAINING_CAL_USD,
SOURCE_SYSTEM_OWNERSHIP_CODE,
FRIDAY_INDICATOR,
NEW_ITEM_INDICATOR,
RESOLVED_INDICATOR,
UNIQUE_ID,
PRODUCT_3_NAME,
AMT_REMAINING_CAL_USD_CATEGORY,
FIRM_MNEMONIC,
AFFIRMATION_INDICATOR,
MTM_PRICE,
MTM_AVAILABLE,
MTM_PRICE_USD,
TRADE_PRICE_USD,
MTM_TRADE_VALUE_USD,
TRADE_VALUE_USD,
MTM_RISK,
MTM_EXPOSURE_USD,
MTM_EXPOSURE_USD_ABS,
MTM_EXPOSURE_BANDING,
COUNTERPARTY_ACC_NUM_CPI,
AGE_BUSINESS_DAYS,
PRODUCT_2_NAME,
RESOLVED_DATE,
COUNTERPARTY_ACC_NUM,
COUNTERPARTY_ACC_NUM_IMS,
TRADE_ENTRY_DATE,
SETTLEMENT_BANK_LOCATION,
BUSINESS_AREA,
MATCH_STATUS_DESCRIPTION,
LATE_ENTRY_ITEM,
ITEM_COUNT,
CLU_DUP_IND,
LGL_ENTY_KEY,
ASET_CLAS_KEY,
RIC_CD,
ACTL_MKT_SETL_KEY,
FO_KEY,
AGT_BANK,
DELV_DT,
DELV_CMT,
RECV_CMT,
CHILLED_IND,
OPER_AGE_BAND,
BTCH_SETL_IND,
MEASMT_TYP,
PROC_COD,
JRULES_RULE_ID,
NORM_FAIL_REASON_CD,
GEMS_RESN_CD,
GEMS_RESN_DESC,
GEMS_COMM,
GEMS_STA,
PRE_SETL_AGE_BAND,
LINKED_TRD_REF,
LINKED_TRD_STAT,
STGY_CD,
GL_SUB_ACCT_UNMAPPED,
EXEC_TYP,
CMSN,
OFCE_LOCA_REF,
COS_LOCA,
ALOC_GRP,
INSR_REF,
INSR_CAT,
STGY_GRP_REF,
STGY_GRP_NM,
TRD_STA,
GAIN_LOSS,
MO_AGE_BAND,
LST_ENTR_DT,
LST_ENTR_AGE,
LST_ENTR_AGE_BAND,
LST_ENTR_SETL_AGE,
LST_ENTR_SETL_AGE_BAND,
BUYIN_FLAG,
BUYIN_TRANS_IND,
BUYIN_RESN,
BUYIN_DUE_DT,
WOW_NEW_ITEM_IND,
WOW_RSLVD_IND,
CNTR_IND,
ORIG_TRD_REF_NO,
OBLIG_ID_CNTRL_NBR,
PAIR_OFF_IND,
TD_AGE_BAND,
FTB_IND,
COMPRESSION_IND,
MKT_RISK,
TD_AGE,
FTB_OS_NET_TRD_QTY,
FTB_OS_NET_TRD_VAL,
FTB_OS_NET_SETL_QTY,
FTB_OS_NET_SETL_VAL,
FTB_OS_CNT,
FTB_COB_DATE,
CAL_PRC,
AGT_ID,
SETL_AGE_BUS_DAYS,
SETL_TYP,
TRD_LEG,
AFRM_STA,
NORM_INSR_STA,
NORM_MTCH_STA,
PRE_SETL_AGE_BND_1,
SETL_CYC_BND,
PRE_SETL_EVNT_TYP,
EXEC_TYP_1,
MATCH_STAT_ID,
DOGS_USER_ID,
BAL_ORD_IND,
DUP_IND,
VLD_PF,
VLD_STA,
COUPON_DIV_RT,
COUPON_DIV_TYP,
CNS_IND,
REC_ELG_IND,
WHN_ISS_IND,
WHN_ISS_CD,
AFRM_IND_1,
VLD_OWN_CD,
IRIS_VLD_STA,
OW_SRC,
AFRM_IND_REF_1,
AFRM_IND_2,
AFRM_IND_REF_2,
TD_AGE_BND_1,
RISK_PF_IND,
TD_AGE_BND_2,
PRE_SETL_AGE_BND_2,
TML_TRD_REF,
CPT_UID_GRD,
RISK_RATING,
INTERCMPY_RECON_MATCH_STA,
INTERCMPY_MATCH_ID,
GL_CODE,
GL_KEY,
EST_EVENT_TYPE,
AFFIRMATION_INDICATOR_TPS_STP,
AFFIRMATION_IND_TPS_STP_REF,
INTERCO_REC_SOURCE_DUP_MTCH_ID,
DTC_ELIGIBLE_VALUE,
TRAILER_NOTES,
RISK_PROFILE_IND2,
AFFIRMATION_IND_SNACC,
AFFIRMATION_IND_SNACC_REF,
TRD_DT_AGE_CAL_DAYS,
TRD_DT_AGE_BAND_CAL_DAYS,
UNIQ_TESID,
AFFIRMATION_INDICATOR_TPS,
AFFIRMATION_IND_TPS_REF,
VALIDATION_SOURCE,
DOGS_INPUTTER_ID,
ETID_REFERENCE,
INTERCO_WAMMING_DETAILS,
AFFIRMATION_INDICATOR_FWS,
AFFIRMATION_IND_FWS_REF,
FWS_FAR_LEG_DERIVED,
FWS_OPEN_ENDED_TRD_IND,
P_S_SETTLEMENT_DATE,
FWS_NEAR_FAR_LEG_IND,
FWS_NEAR_TRD_BO_TRD_ID,
FWS_FAR_TRD_BO_TRD_ID,
OPN_END_NEAR_TRD_BO_TRD_ID,
OPN_END_FAR_TRD_BO_TRD_ID,
FWS_OPEN_ENDED_BUY_BACK_DT,
FWS_OPEN_ENDED_MTCH_LEG_IDNTFR,
EXTNL_TRD_ID,
OCEAN_TPS_TRADERID,
OCEAN_TPS_SALESID,
OCEAN_TPS_ENTRY_USER_ID,
OCEAN_TPS_MODIFY_ENTRY_USER_ID,
OCEAN_TPS_AMEND_REASON_TXT,
OCEAN_TPS_SALES_NOTE_TXT,
OCEAN_TPS_TRADER_NOTE_TXT,
OCEAN_TPS_MENO_NOTE_TXT,
ALPS_PRODUCT,
PRE_SETL_AGE_BND_3,
RISK_PROF_AGE_BND,
IRIS_COMMENTS,
OPS_FAILS_ROOT_CAUSE_OWNR,
OPS_FAILS_ROOT_CAUSE_CODE,
OPS_FAILS_ACTION_OWNR,
OPS_FAILS_ACTION_CODE,
OCEAN_TPS_SYSTEM,
OCEAN_TPS_TRD_TYPE,
AFFIRMATION_IND_TPS_STP_ECN,
VAL_DT,
VAL_AGE,
VALIDATED_IND,
TRD_DT_AGE_BND_BUS,
TRD_DT_AGE_BND_CAL,
COMPASS_TRADE_ID,
GENERIC_REF_FIELD_1,
GENERIC_REF_FIELD_2,
IS_DOCHILL,
GLBL_LCK_IND,
FO_AGE_BAND,
SMC_SEC_PROD_ID,
OPS_FAILS_RSN_CODE,
FRC_AUTOCODED_IND,
FULL_KEY_ERECON,
FULL_KEY_NEW,
ESALES_CTP_NAM,
ESALES_MG_NAME,
PROC_LOC,
DESK_ALLOCATION_IND,
ALPS_SUB_PRODUCT,
PRIME_BROKERAGE_TRAN_IND,
SECONDARY_FRC,
SECONDARY_FRC_STATUS,
DERIVED_TRADER_NAME,
VLD_OWN_SRC 
from csmartbser.fails_reports_history where sourcesystem='IOWA' and cob_date='05-MAY-15']]>

      </sql_template>
   </table_utils>
  </exec_query_copy>

</worker>



</etldataflow>
